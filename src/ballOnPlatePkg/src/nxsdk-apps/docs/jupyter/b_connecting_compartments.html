

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>2. Connecting compartments &mdash; NxSDK 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Stimulating compartments" href="c_stimulating_compartments.html" />
    <link rel="prev" title="1. Compartment, CompartmentPrototype and Probes Setup" href="a_compartment_setup.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NxSDK
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introductory Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxapi.html">NxAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxnet.html">NxNet API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxcore.html">NxCore API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composable.html">Composability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../embedded_execution_engine.html">Embedded Execution Engine</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../nxnet_tutorials.html">NxNet Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="a_compartment_setup.html">1. Compartment, CompartmentPrototype and Probes Setup</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2. Connecting compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#1.-Connecting-single-compartments">2.1. 1. Connecting single compartments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#2.-Connecting-compartment-groups-with-discrete-weight-and-delay-matrices">2.2. 2. Connecting compartment groups with discrete weight and delay matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#3.-Connecting-compartment-groups-with-axon-delays">2.3. 3. Connecting compartment groups with axon delays</a></li>
<li class="toctree-l4"><a class="reference internal" href="#4.-Create-connections-with-different-sign-mode">2.4. 4. Create connections with different sign mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#5.-Create-connections-with-different-post-synaptic-response-mode">2.5. 5. Create connections with different post synaptic response mode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="c_stimulating_compartments.html">3. Stimulating compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="d_synaptic_plasticity.html">4. Synaptic plasticity</a></li>
<li class="toctree-l3"><a class="reference internal" href="e_neuronal_homeostasis.html">5. Neuronal homeostasis</a></li>
<li class="toctree-l3"><a class="reference internal" href="f_rewards_learning.html">6. Learning with Rewards</a></li>
<li class="toctree-l3"><a class="reference internal" href="g_snip_for_threshold_modulation.html">7. SNIPs</a></li>
<li class="toctree-l3"><a class="reference internal" href="h_reward_trace.html">8. Reward Trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="i_performance_profiling.html">9. Performance profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_core.html">10. Hard vs.Â soft membrane voltage reset</a></li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_net.html">11. Soft reset membrane voltage</a></li>
<li class="toctree-l3"><a class="reference internal" href="k_interactive_spike_sender_receiver.html">12. Interactive Spike Sender and Spike Receivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="l_snip_for_compartment_setup_with_NxNet_C.html">13. Setup Compartments with NxNet C API</a></li>
<li class="toctree-l3"><a class="reference internal" href="m_independent_networks_in_same_run.html">14. Independent Networks in Same Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html">15. Stochastic Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#C.-Puttin-It-All-Together">16. C. Puttin It All Together</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#Modify-createWtaMotif1-to-Include-Detector-Neuron">17. Modify createWtaMotif1 to Include Detector Neuron</a></li>
<li class="toctree-l3"><a class="reference internal" href="o_snip_for_reading_lakemont_spike_count.html">18. Read Lakemont Spike Count</a></li>
<li class="toctree-l3"><a class="reference internal" href="p_composable_networks.html">19. Composable Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="q_connection_sharing.html">20. Connection Sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html">21. Stubs and NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html#NetModules">22. NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="s_multicx_neuron_self_reward.html">23. Implementation of a multi-compartment neuron with self-reward feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="t_vMinExp_and_vMaxExp.html">24. vMinExp and vMaxExp Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html">25. Neurons vs Compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html#Multi-compartment-neurons">26. Multi-compartment neurons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../nxcore_tutorials.html">NxCore Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Nx SDK Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance-suite.html">NxSDK Performance Test Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">NxSDK Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NxSDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
          <li><a href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">2. </span>Connecting compartments</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># INTEL CORPORATION CONFIDENTIAL AND PROPRIETARY</span>
<span class="c1">#</span>
<span class="c1"># Copyright Â© 2018-2021 Intel Corporation.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are Intel copyrighted</span>
<span class="c1"># materials, and your use of them is governed by the express</span>
<span class="c1"># license under which they were provided to you (License). Unless</span>
<span class="c1"># the License provides otherwise, you may not use, modify, copy,</span>
<span class="c1"># publish, distribute, disclose or transmit  this software or the</span>
<span class="c1"># related documents without Intel&#39;s prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are provided as is, with</span>
<span class="c1"># no express or implied warranties, other than those that are</span>
<span class="c1"># expressly stated in the License.</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">config</span> IPCompleter.greedy=True
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nxsdk.api.n2a</span> <span class="k">as</span> <span class="nn">nx</span>
</pre></div>
</div>
</div>
<div class="section" id="Connecting-compartments">
<h1><span class="section-number">2. </span>Connecting compartments<a class="headerlink" href="#Connecting-compartments" title="Permalink to this headline">Â¶</a></h1>
<p>Compartments can be connected to other compartments via a connections. Just like compartment groups, connection groups use connection prototypes to configure the individual connections contained in the group. See the documentation for a list of all configurable connection parameters. Here we connect different source and destination compartments to focus on different features of connections: 1. First, weâll create a connection with mostly default parameters between two single compartments. 2.
Next we illustrate how to connect compartment groups and assign discrete weight and delay matrices. 3. Then we show how to create excitatory, inhibitory as well as mixed sign weights. 4. Finally we demonstrate how to use the two different post synaptic response modes.</p>
<p><img alt="Connecting Compartments" src="../_images/jupyter_connecting_compartments.png" /></p>
<div class="section" id="1.-Connecting-single-compartments">
<h2><span class="section-number">2.1. </span>1. Connecting single compartments<a class="headerlink" href="#1.-Connecting-single-compartments" title="Permalink to this headline">Â¶</a></h2>
<p>For the first example, we connect two individual compartments with mostly default paramters with a weight 10 and a weight scaling exponent of 1. Thus the accumulated weights in the post synaptic compartment from each input will be 10 * 2 ** (6+1)=1280. The exponent of 6 is an implicit global scaling of all weights.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty network.</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NxNet</span><span class="p">()</span>

<span class="c1"># Create source compartment</span>
<span class="n">cxProtoSrc</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">biasMant</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                     <span class="n">biasExp</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                                     <span class="n">vThMant</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                                     <span class="n">functionalState</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">COMPARTMENT_FUNCTIONAL_STATE</span><span class="o">.</span><span class="n">IDLE</span><span class="p">)</span>
<span class="n">cxSrc</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartment</span><span class="p">(</span><span class="n">prototype</span><span class="o">=</span><span class="n">cxProtoSrc</span><span class="p">)</span>

<span class="c1"># Create destination compartment</span>
<span class="n">cxProtoDst</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">vThMant</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                     <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">4095</span><span class="p">)</span>
<span class="n">cxDst</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartment</span><span class="p">(</span><span class="n">prototype</span><span class="o">=</span><span class="n">cxProtoDst</span><span class="p">)</span>

<span class="c1"># Connect compartments</span>
<span class="n">connProto</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">weightExponent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">cxSrc</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cxDst</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">connProto</span><span class="p">)</span>

<span class="c1"># Define probes</span>
<span class="n">cxSrcSProbe</span> <span class="o">=</span> <span class="n">cxSrc</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cxDstUProbe</span> <span class="o">=</span> <span class="n">cxDst</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cxDstVProbe</span> <span class="o">=</span> <span class="n">cxDst</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cxDstSProbe</span> <span class="o">=</span> <span class="n">cxDst</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Run network</span>
<span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

<span class="c1"># Plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">uh</span> <span class="o">=</span> <span class="n">cxDstUProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination compartmentCurrent&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">vh</span> <span class="o">=</span> <span class="n">cxDstVProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination compartmentVoltage&#39;</span><span class="p">)</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">cxDstSProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination spikes&#39;</span><span class="p">)</span>

<span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">srch</span> <span class="o">=</span> <span class="n">cxSrcSProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Source spikes&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Since the compartmentCurrentDecay is set to its maximum value, the compartmentCurrent decays instantly. The</span>
<span class="c1"># membrane threshold is set to 100*2**6=6400, so it takes six spikes to drive the membrane above the threshold and cause</span>
<span class="c1"># a destination output spike.</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SLURM is being run in background
Connecting to 134.134.68.80:18861
N2Driver: Running...
    Compiling synapses... Done (0.00s)
    Processing probes... Done (0.00s)
    Writing modified registers... Done (0.05s)
    Initializing... Done (0.01s)
    Preparing input... Done (0.00s)
    Executing... Done (0.01s)
    Processing timeSeries... Done (0.01s)
N2Driver: Finished (0.08s)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_b_connecting_compartments_4_1.png" src="../_images/jupyter_b_connecting_compartments_4_1.png" />
</div>
</div>
</div>
<div class="section" id="2.-Connecting-compartment-groups-with-discrete-weight-and-delay-matrices">
<h2><span class="section-number">2.2. </span>2. Connecting compartment groups with discrete weight and delay matrices<a class="headerlink" href="#2.-Connecting-compartment-groups-with-discrete-weight-and-delay-matrices" title="Permalink to this headline">Â¶</a></h2>
<p>Often, weâd like to assign discrete weights and delays to a connection group. This can be done by passing a weight and delay matrix to the connect(..) method. Passing in such a weight and delay matrix will overwrite the corresponding default paramter set in the connection prototype. By default, this will connect all source comaprtments to all destination compartments. If the connectivity is sparse, we can pass an additional binary connection mask to the connect(..) method where each non-zero
element specifies for which connections to allocate memory.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty network.</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NxNet</span><span class="p">()</span>

<span class="c1"># Create source compartment group.</span>
<span class="n">cxProtoSrc</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">biasMant</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                     <span class="n">biasExp</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                                     <span class="n">vThMant</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                                     <span class="n">functionalState</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">COMPARTMENT_FUNCTIONAL_STATE</span><span class="o">.</span><span class="n">IDLE</span><span class="p">)</span>
<span class="n">cxSrc</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartmentGroup</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">prototype</span><span class="o">=</span><span class="n">cxProtoSrc</span><span class="p">)</span>

<span class="c1"># Create destination compartment group.</span>
<span class="n">cxProtoDst</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">vThMant</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                     <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">4095</span><span class="p">)</span>
<span class="n">cxDst</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartmentGroup</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">prototype</span><span class="o">=</span><span class="n">cxProtoDst</span><span class="p">)</span>

<span class="c1"># Connect compartment groups</span>
<span class="n">connProto</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">()</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">cxSrc</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cxDst</span><span class="p">,</span>
                     <span class="n">prototype</span><span class="o">=</span><span class="n">connProto</span><span class="p">,</span>
                     <span class="n">weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
                                      <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]]),</span>
                     <span class="n">delay</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                     <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]),</span>
                     <span class="n">connectionMask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]))</span>

<span class="c1"># Define probes</span>
<span class="p">(</span><span class="n">cxSrcSProbe</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cxSrc</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">])</span>
<span class="p">(</span><span class="n">cxDstUProbe</span><span class="p">,</span> <span class="n">cxDstVProbe</span><span class="p">,</span> <span class="n">cxDstSProbe</span><span class="p">)</span> <span class="o">=</span> <span class="n">cxDst</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">,</span>
                                                      <span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">,</span>
                                                      <span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">])</span>

<span class="c1"># Run network</span>
<span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

<span class="c1"># Plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">uh</span> <span class="o">=</span> <span class="n">cxDstUProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination compartmentCurrent&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">uh</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;dstCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uh</span><span class="p">))])</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">vh</span> <span class="o">=</span> <span class="n">cxDstVProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination compartmentVoltage&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">uh</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;dstCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uh</span><span class="p">))])</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">cxDstSProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination spikes&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">uh</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;dstCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uh</span><span class="p">))])</span>

<span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">srch</span> <span class="o">=</span> <span class="n">cxSrcSProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">])</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Source spikes&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">srch</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;srcCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">srch</span><span class="p">))])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Source compartment srcCx=0 connects to dstCx=1 with (weight=30, delay=5) while srcCx=1 connects to dstCx=0 with</span>
<span class="c1"># (weight=20, delay=0) which leads to destCx=0 and destCx=1 impulses of the compartmentCurrent by 1280 and 1920,</span>
<span class="c1"># respectively, at 1 and 6 time steps after the source compartment spikes at t=11, ...</span>
<span class="c1"># The destination compartments themselves spike once their compartment voltage exceeds the membrane threshold of 6400.</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SLURM is being run in background
Connecting to 134.134.68.80:18861
N2Driver: Running...
    Compiling synapses... Done (0.00s)
    Processing probes... Done (0.00s)
    Writing modified registers... Done (0.05s)
    Initializing... Done (0.01s)
    Preparing input... Done (0.00s)
    Executing... Done (0.01s)
    Processing timeSeries... Done (0.01s)
N2Driver: Finished (0.08s)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_b_connecting_compartments_6_1.png" src="../_images/jupyter_b_connecting_compartments_6_1.png" />
</div>
</div>
</div>
<div class="section" id="3.-Connecting-compartment-groups-with-axon-delays">
<h2><span class="section-number">2.3. </span>3. Connecting compartment groups with axon delays<a class="headerlink" href="#3.-Connecting-compartment-groups-with-axon-delays" title="Permalink to this headline">Â¶</a></h2>
<p>Axon delay is the time difference between the firing time at soma and the spike time when the destination synapse receives the spike. Parameter axonDelay can be used to configure this delay. Axonal delay applies to the axon, which means a single delay propagates to all connected synapses, while synaptic delay is applied per synapse.</p>
<p>AxonDelay can be applied to destination synapses in the same core as the source axon or in a different core. In the codes below, one source compartment in Core 0 is created, which sends spikes to two destination comparments in Core 1. Each core can only have one tEpoch, and due to hardware restriction, there is limitation of axonDelay &lt;= 3*tEpoch.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">net</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NxNet</span><span class="p">()</span>

<span class="c1"># Create one source compartment</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">biasMant</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                            <span class="n">biasExp</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                            <span class="n">vThMant</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                            <span class="n">functionalState</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">409</span><span class="p">,</span>
                            <span class="n">compartmentVoltageDecay</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                            <span class="n">tEpoch</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                            <span class="n">axonDelay</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                            <span class="n">logicalCoreId</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cxSrcGrp</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartmentGroup</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># Create two destination compartments</span>
<span class="n">pDst</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">vThMant</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span>
                               <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">409</span><span class="p">,</span>
                               <span class="n">compartmentVoltageDecay</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                               <span class="n">tEpoch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                               <span class="n">logicalCoreId</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cxDstGrp</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartmentGroup</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">pDst</span><span class="p">)</span>

<span class="c1"># Connect compartment groups</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">connGrp</span> <span class="o">=</span> <span class="n">cxSrcGrp</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cxDstGrp</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">conn</span><span class="p">)</span>

<span class="c1"># Define probes</span>
<span class="p">(</span><span class="n">vProbes</span><span class="p">,</span> <span class="n">uProbes</span><span class="p">,</span> <span class="n">sProbes</span><span class="p">)</span> <span class="o">=</span> <span class="n">cxSrcGrp</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">,</span>
                                              <span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">,</span>
                                              <span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">])</span>
<span class="p">(</span><span class="n">vDstProbes</span><span class="p">,</span> <span class="n">uDstProbes</span><span class="p">,</span> <span class="n">sDstProbes</span><span class="p">)</span> <span class="o">=</span> <span class="n">cxDstGrp</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">,</span>
                                                       <span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">,</span>
                                                       <span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">])</span>

<span class="c1"># Run network</span>
<span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

<span class="c1"># Plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="c1"># plot source compartment voltage</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">vProbes</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="c1"># plot source compartment spikes with axonDelay from soma</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sProbes</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="c1"># plot destination compartments current</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">uDstProbes</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="c1"># plot destination compartments voltage</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">vDstProbes</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="c1"># plot destination compartments spikes</span>
<span class="n">ax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">sDstProbes</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># Source compartment spike sProbes shown below are not fired immediately when threshold is achieved. There is a delay</span>
<span class="c1"># of axonDelay from soma firing. Destination compartments current, voltage and spike repond to the delayed source</span>
<span class="c1"># compartment spikes.</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SLURM is being run in background
Connecting to 134.134.68.80:18861
N2Driver: Running...
    Compiling synapses... Done (0.00s)
    Processing probes... Done (0.00s)
    Writing modified registers... Done (0.08s)
    Initializing... Done (0.01s)
    Preparing input... Done (0.00s)
    Executing... Done (0.01s)
    Processing timeSeries... Done (0.01s)
N2Driver: Finished (0.12s)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_b_connecting_compartments_8_1.png" src="../_images/jupyter_b_connecting_compartments_8_1.png" />
</div>
</div>
</div>
<div class="section" id="4.-Create-connections-with-different-sign-mode">
<h2><span class="section-number">2.4. </span>4. Create connections with different sign mode<a class="headerlink" href="#4.-Create-connections-with-different-sign-mode" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty network.</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NxNet</span><span class="p">()</span>

<span class="c1"># Create source compartment group.</span>
<span class="n">cxProtoSrc</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">biasMant</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                     <span class="n">biasExp</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                                     <span class="n">vThMant</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                                     <span class="n">functionalState</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">COMPARTMENT_FUNCTIONAL_STATE</span><span class="o">.</span><span class="n">IDLE</span><span class="p">)</span>
<span class="n">cxSrc</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartmentGroup</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">prototype</span><span class="o">=</span><span class="n">cxProtoSrc</span><span class="p">)</span>

<span class="c1"># Create destination compartment group</span>
<span class="n">cxProtoDst</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">vThMant</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                     <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">4095</span><span class="p">)</span>
<span class="n">cxDst</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartmentGroup</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                   <span class="n">prototype</span><span class="o">=</span><span class="n">cxProtoDst</span><span class="p">)</span>

<span class="c1"># Create prototypes with different sign modes for connections</span>
<span class="n">connProtoEx</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">signMode</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">SYNAPSE_SIGN_MODE</span><span class="o">.</span><span class="n">EXCITATORY</span><span class="p">)</span>
<span class="n">connProtoInh</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">signMode</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">SYNAPSE_SIGN_MODE</span><span class="o">.</span><span class="n">INHIBITORY</span><span class="p">)</span>
<span class="n">connProtoMixed</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">signMode</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">SYNAPSE_SIGN_MODE</span><span class="o">.</span><span class="n">MIXED</span><span class="p">)</span>

<span class="c1"># Connect source with destination compartment group</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">cxSrc</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cxDst</span><span class="p">,</span>
                    <span class="n">prototype</span><span class="o">=</span><span class="p">[</span><span class="n">connProtoEx</span><span class="p">,</span> <span class="n">connProtoInh</span><span class="p">,</span> <span class="n">connProtoMixed</span><span class="p">],</span>
                    <span class="n">prototypeMap</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                           <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                           <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span>
                    <span class="n">weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
                                     <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                                     <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">]]))</span>

<span class="c1"># Define probes</span>
<span class="p">(</span><span class="n">cxSrcSProbe</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cxSrc</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">])</span>
<span class="p">(</span><span class="n">cxDstUProbe</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cxDst</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">])</span>
<span class="p">(</span><span class="n">cxDstVProbe</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cxDst</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">])</span>
<span class="p">(</span><span class="n">cxDstSProbe</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cxDst</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">])</span>

<span class="c1"># Run network</span>
<span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

<span class="c1"># Plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">uh</span> <span class="o">=</span> <span class="n">cxDstUProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination compartmentCurrent&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">uh</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;dstCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uh</span><span class="p">))])</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">vh</span> <span class="o">=</span> <span class="n">cxDstVProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination compartmentVoltage&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">uh</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;dstCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uh</span><span class="p">))])</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">cxDstSProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination spikes&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">uh</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;dstCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uh</span><span class="p">))])</span>

<span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">srch</span> <span class="o">=</span> <span class="n">cxSrcSProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">])</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Source spikes&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">srch</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;srcCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">srch</span><span class="p">))])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># The first and second destination compartment dstCx=0/dstCx=1 receive input from excitatory/inhibitory-only synapses with</span>
<span class="c1"># a weight of 40/-20 and thus their compartment current increases/decreases by 40*2**6=2560 and -20*2**6=-1280,</span>
<span class="c1"># respectively. Thus, dstCx=0 spikes at a high frequency whereas dstCx=1 never spikes.</span>
<span class="c1"># The third destination compartment dstCx=2 receives input from two mixed sign synapses with a weight of</span>
<span class="c1"># (-20+40)*2**6=1280. Thus, dstCx=2 spikes at half the frequencey of dstCx0.</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SLURM is being run in background
Connecting to 134.134.68.80:18861
N2Driver: Running...
    Compiling synapses... Done (0.00s)
    Processing probes... Done (0.00s)
    Writing modified registers... Done (0.05s)
    Initializing... Done (0.01s)
    Preparing input... Done (0.00s)
    Executing... Done (0.01s)
    Processing timeSeries... Done (0.01s)
N2Driver: Finished (0.09s)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_b_connecting_compartments_10_1.png" src="../_images/jupyter_b_connecting_compartments_10_1.png" />
</div>
</div>
</div>
<div class="section" id="5.-Create-connections-with-different-post-synaptic-response-mode">
<h2><span class="section-number">2.5. </span>5. Create connections with different post synaptic response mode<a class="headerlink" href="#5.-Create-connections-with-different-post-synaptic-response-mode" title="Permalink to this headline">Â¶</a></h2>
<p>There are two post synaptic response modes: EXPONENTIAL and BOX. For EXPONENTIAL, the compartment current decays exponentially with a certain time constant after each input spike whereas for BOX, the compartment current increases by the amount of the input weight, remains constant for the duration of the box profile and then decreases by the amount of the weight at once. For a BOX synapse, the synaptic delay value is interpreted as the duration of the BOX post synaptic response. A compartment
should only receive input from synapses with one post synaptic response mode.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty network.</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NxNet</span><span class="p">()</span>

<span class="c1"># Create source compartment group.</span>
<span class="n">cxProtoSrc</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">biasMant</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                     <span class="n">biasExp</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                                     <span class="n">vThMant</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                                     <span class="n">functionalState</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">COMPARTMENT_FUNCTIONAL_STATE</span><span class="o">.</span><span class="n">IDLE</span><span class="p">,</span>
                                     <span class="n">logicalCoreId</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cxSrc</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartmentGroup</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">prototype</span><span class="o">=</span><span class="n">cxProtoSrc</span><span class="p">)</span>

<span class="c1"># Create destination compartment group. We create one destination compartment with a finite exponential decay time</span>
<span class="c1"># constant which receives input from EXPONENTIAL synapses and we create another compartment without decay which receives</span>
<span class="c1"># input from BOX synapses.</span>
<span class="n">tauU</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">cxProtoDstExp</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">vThMant</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                        <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tauU</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">),</span>
                                        <span class="n">logicalCoreId</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cxProtoDstBox</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">vThMant</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                        <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                        <span class="n">logicalCoreId</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cxDst</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartmentGroup</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">prototype</span><span class="o">=</span><span class="p">[</span><span class="n">cxProtoDstExp</span><span class="p">,</span> <span class="n">cxProtoDstBox</span><span class="p">],</span>
                                   <span class="n">prototypeMap</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Create prototypes with different post synaptic response modes and a default weight.</span>
<span class="n">connProtoExp</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                      <span class="n">postSynResponseMode</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">SYNAPSE_POST_SYN_RESPONSE_MODE</span><span class="o">.</span><span class="n">EXPONENTIAL</span><span class="p">)</span>
<span class="n">connProtoBox</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                      <span class="n">postSynResponseMode</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">SYNAPSE_POST_SYN_RESPONSE_MODE</span><span class="o">.</span><span class="n">BOX</span><span class="p">)</span>

<span class="c1"># Connect source with destination compartment group. For the second compartment we set a synaptic delay of 5 which will</span>
<span class="c1"># be interpreted as the duration of the BOX post synaptic response profile.</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">cxSrc</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cxDst</span><span class="p">,</span>
                    <span class="n">prototype</span><span class="o">=</span><span class="p">[</span><span class="n">connProtoExp</span><span class="p">,</span> <span class="n">connProtoBox</span><span class="p">],</span>
                    <span class="n">prototypeMap</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                           <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]),</span>
                    <span class="n">delay</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]))</span>

<span class="c1"># Define probes</span>
<span class="p">(</span><span class="n">cxSrcSProbe</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cxSrc</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">])</span>
<span class="p">(</span><span class="n">cxDstUProbe</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cxDst</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">])</span>
<span class="p">(</span><span class="n">cxDstVProbe</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cxDst</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">])</span>
<span class="p">(</span><span class="n">cxDstSProbe</span><span class="p">,)</span> <span class="o">=</span> <span class="n">cxDst</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">])</span>

<span class="c1"># Run network</span>
<span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

<span class="c1"># Plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">uh</span> <span class="o">=</span> <span class="n">cxDstUProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination compartmentCurrent&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">uh</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;dstCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uh</span><span class="p">))])</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">vh</span> <span class="o">=</span> <span class="n">cxDstVProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination compartmentVoltage&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">uh</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;dstCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uh</span><span class="p">))])</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">cxDstSProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Destination spikes&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">uh</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;dstCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uh</span><span class="p">))])</span>

<span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">srch</span> <span class="o">=</span> <span class="n">cxSrcSProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">])</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Source spikes&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">srch</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;srcCx=</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">srch</span><span class="p">))])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># The first destination compartment dstCx=0 receives only input from exponential synapses and has a finite compartment</span>
<span class="c1"># current decay time constant. As a result, its compartmentCurrent decays exponentially after each input spike.</span>
<span class="c1"># In contrast, the second destination compartment dstCx=1 receives only input from box synapses, therefore its</span>
<span class="c1"># compartmentCurrent remains constant for the duration of the post synaptic response and then drops to zero instantly.</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SLURM is being run in background
Connecting to 134.134.68.80:18861
N2Driver: Running...
    Compiling synapses... Done (0.00s)
    Processing probes... Done (0.00s)
    Writing modified registers... Done (0.08s)
    Initializing... Done (0.01s)
    Preparing input... Done (0.00s)
    Executing... Done (0.01s)
    Processing timeSeries... Done (0.01s)
N2Driver: Finished (0.12s)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_b_connecting_compartments_12_1.png" src="../_images/jupyter_b_connecting_compartments_12_1.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="c_stimulating_compartments.html" class="btn btn-neutral float-right" title="3. Stimulating compartments" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="a_compartment_setup.html" class="btn btn-neutral float-left" title="1. Compartment, CompartmentPrototype and Probes Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, Intel Corporation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>