

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>6. Learning with Rewards &mdash; NxSDK 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. SNIPs" href="g_snip_for_threshold_modulation.html" />
    <link rel="prev" title="5. Neuronal homeostasis" href="e_neuronal_homeostasis.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NxSDK
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introductory Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxapi.html">NxAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxnet.html">NxNet API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxcore.html">NxCore API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composable.html">Composability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../embedded_execution_engine.html">Embedded Execution Engine</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../nxnet_tutorials.html">NxNet Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="a_compartment_setup.html">1. Compartment, CompartmentPrototype and Probes Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="b_connecting_compartments.html">2. Connecting compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="c_stimulating_compartments.html">3. Stimulating compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="d_synaptic_plasticity.html">4. Synaptic plasticity</a></li>
<li class="toctree-l3"><a class="reference internal" href="e_neuronal_homeostasis.html">5. Neuronal homeostasis</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">6. Learning with Rewards</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Network-Architecture">6.1. Network Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Setup-and-Configure-Network">6.2. Setup and Configure Network</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Configure-Probes">6.3. Configure Probes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Run-the-Network">6.4. Run the Network</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Results">6.5. Results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="g_snip_for_threshold_modulation.html">7. SNIPs</a></li>
<li class="toctree-l3"><a class="reference internal" href="h_reward_trace.html">8. Reward Trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="i_performance_profiling.html">9. Performance profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_core.html">10. Hard vs.Â soft membrane voltage reset</a></li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_net.html">11. Soft reset membrane voltage</a></li>
<li class="toctree-l3"><a class="reference internal" href="k_interactive_spike_sender_receiver.html">12. Interactive Spike Sender and Spike Receivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="l_snip_for_compartment_setup_with_NxNet_C.html">13. Setup Compartments with NxNet C API</a></li>
<li class="toctree-l3"><a class="reference internal" href="m_independent_networks_in_same_run.html">14. Independent Networks in Same Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html">15. Stochastic Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#C.-Puttin-It-All-Together">16. C. Puttin It All Together</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#Modify-createWtaMotif1-to-Include-Detector-Neuron">17. Modify createWtaMotif1 to Include Detector Neuron</a></li>
<li class="toctree-l3"><a class="reference internal" href="o_snip_for_reading_lakemont_spike_count.html">18. Read Lakemont Spike Count</a></li>
<li class="toctree-l3"><a class="reference internal" href="p_composable_networks.html">19. Composable Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="q_connection_sharing.html">20. Connection Sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html">21. Stubs and NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html#NetModules">22. NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="s_multicx_neuron_self_reward.html">23. Implementation of a multi-compartment neuron with self-reward feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="t_vMinExp_and_vMaxExp.html">24. vMinExp and vMaxExp Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html">25. Neurons vs Compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html#Multi-compartment-neurons">26. Multi-compartment neurons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../nxcore_tutorials.html">NxCore Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Nx SDK Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance-suite.html">NxSDK Performance Test Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">NxSDK Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NxSDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
          <li><a href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">6. </span>Learning with Rewards</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># INTEL CORPORATION CONFIDENTIAL AND PROPRIETARY</span>
<span class="c1">#</span>
<span class="c1"># Copyright Â© 2018-2021 Intel Corporation.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are Intel copyrighted</span>
<span class="c1"># materials, and your use of them is governed by the express</span>
<span class="c1"># license under which they were provided to you (License). Unless</span>
<span class="c1"># the License provides otherwise, you may not use, modify, copy,</span>
<span class="c1"># publish, distribute, disclose or transmit  this software or the</span>
<span class="c1"># related documents without Intel&#39;s prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are provided as is, with</span>
<span class="c1"># no express or implied warranties, other than those that are</span>
<span class="c1"># expressly stated in the License.</span>
</pre></div>
</div>
</div>
<div class="section" id="Learning-with-Rewards">
<h1><span class="section-number">6. </span>Learning with Rewards<a class="headerlink" href="#Learning-with-Rewards" title="Permalink to this headline">Â¶</a></h1>
<p>Loihi provides the capability to send reinforcement signals to learning enabled connections. This tutorial shows how to reinforce the contingent firing of two neurons by a delayed reward. This is the fundamental mechanism described by Izhikevich in [1].</p>
<p>[1] Izhikevich EM. Solving the distal reward problem through linkage of STDP and dopamine signaling. Cerebral Cortex. 2007; 17(10):2443-52</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">nxsdk.api.n2a</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="section" id="Network-Architecture">
<h2><span class="section-number">6.1. </span>Network Architecture<a class="headerlink" href="#Network-Architecture" title="Permalink to this headline">Â¶</a></h2>
<p>The following figure illustrates the overview of the network:</p>
<p><img alt="Rewards" src="../_images/jupyter_rewards.png" /></p>
<p>The details of the network used in the tutorial can be found in the illustration below:</p>
<p><img alt="Rewards Learning Tutorial" src="../_images/rewards_learning_tutorial.png" /></p>
<p>The thresholds for compartment c1 and c2 and the synaptic weights in connections connPreSynSpikeToC2 and connPostSynSpikeToC1 are chosen so that c1 and c2 spike immediately upon receiving an incoming spike.</p>
<p>The threshold in compartment c3 and the synaptic weights in connection conn13 and conn23 chosen so that âpost-synapticâ spikes entering from conn13 result in compartment 3 spikes, while the âpre-synapticâ spikes entering from conn23 do not result in compartment 3 spikes.</p>
</div>
<div class="section" id="Setup-and-Configure-Network">
<h2><span class="section-number">6.2. </span>Setup and Configure Network<a class="headerlink" href="#Setup-and-Configure-Network" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">net</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NxNet</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="Setup-Compartment-Prototypes">
<h3><span class="section-number">6.2.1. </span>Setup Compartment Prototypes<a class="headerlink" href="#Setup-Compartment-Prototypes" title="Permalink to this headline">Â¶</a></h3>
<p>Compartment parameters are defined as follows:</p>
<ul class="simple">
<li><p>vThMant: Actual numerical threshold is 150*(2^6) = 9600.</p></li>
<li><p>compartmentCurrentDecay: current decay set to the maximum decay</p></li>
<li><p>compartmentVoltageDecay: voltage decay set to the maximum decay</p></li>
<li><p>enableSpikeBackprop: Enables back propagating action potentials (post-traces)</p></li>
<li><p>enableSpikeBackpropFromSelf: Activate back propagating action potentials when the compartment spikes</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pbasic</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">vThMant</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                                 <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">4095</span><span class="p">,</span>
                                 <span class="n">compartmentVoltageDecay</span><span class="o">=</span><span class="mi">4095</span><span class="p">)</span>

<span class="n">plrn</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">vThMant</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                               <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">4095</span><span class="p">,</span>
                               <span class="n">compartmentVoltageDecay</span><span class="o">=</span><span class="mi">4095</span><span class="p">,</span>
                               <span class="n">enableSpikeBackprop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">enableSpikeBackpropFromSelf</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Setup-Learning-Rule-and-Connection-Prototypes">
<h3><span class="section-number">6.2.2. </span>Setup Learning Rule and Connection Prototypes<a class="headerlink" href="#Setup-Learning-Rule-and-Connection-Prototypes" title="Permalink to this headline">Â¶</a></h3>
<p>The learning rules used for the tag <span class="math notranslate nohighlight">\(t\)</span> and weight <span class="math notranslate nohighlight">\(w\)</span> variable are given by:</p>
<div class="math notranslate nohighlight">
\[dt=y_0 \cdot x_1 - x_0 \cdot y_1 - 2^{-2}\cdot u_0 \cdot t\]</div>
<div class="math notranslate nohighlight">
\[dw=2\cdot u_0\cdot r_1 \cdot t\]</div>
<ul class="simple">
<li><p>dt: The tag field is used as the âeligibility traceâ described in [1]. This is analogous to standard excitatory STDP learning rule with the exception that the weight change is not immediately stored in the weight variable but the tag variable and it decays exponentially over time. Whereas any spike induced potentiation or depression is conditioned on post or pre synaptic spikes during the learning epoch (<span class="math notranslate nohighlight">\(y_0\)</span>, <span class="math notranslate nohighlight">\(x_0\)</span>), the tag decay is unconditionally executed with a decimate
exponent of 0 (<span class="math notranslate nohighlight">\(u_0\)</span>).</p></li>
<li><p>dw: The synaptic weight is adjusted on the existence of a reinforcement signal and the state of the tag (âeligibility traceâ).</p></li>
</ul>
<p>All trace variables used in the <span class="math notranslate nohighlight">\(dw\)</span> and <span class="math notranslate nohighlight">\(dt\)</span> equations (<span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(y_1\)</span>, <span class="math notranslate nohighlight">\(r_1\)</span>) are further configured by the following parameters: - x1Impulse, x2Impulse, r1Impulse: The increase in the trace value on the occurrence of a pre-synaptic, post-synaptic, and reinforcement spike. Maximum value of 127.</p>
<ul class="simple">
<li><p>x1TimeConstant, x2TimeConstant, r1TimeConstant: Pre-synaptic, post-synaptic, and reward trace exponential decay time constant set to 4 time steps.</p></li>
</ul>
<p>Finally all learning rules leading to synaptic state updates are executed with a certain periodicity which is the duration of the learning epoch (tEpoch). This parameter should in general be set as large as possible (for faster execution) but small enough to ensure at most one spike per tEpoch. A power of two will in general be most efficient. Note: tEpoch has to be the same for all learning rules in the network.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createLearningRule</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="s1">&#39;x1*y0-x0*y1-2^-2*u0*t&#39;</span><span class="p">,</span>
                            <span class="n">dw</span><span class="o">=</span><span class="s1">&#39;2*u0*r1*t&#39;</span><span class="p">,</span>
                            <span class="n">x1Impulse</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                            <span class="n">x1TimeConstant</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                            <span class="n">y1Impulse</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                            <span class="n">y1TimeConstant</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                            <span class="n">r1Impulse</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                            <span class="n">r1TimeConstant</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                            <span class="n">tEpoch</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">connProto2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">enableLearning</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">learningRule</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span><span class="n">numTagBits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                    <span class="n">signMode</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">SYNAPSE_SIGN_MODE</span><span class="o">.</span><span class="n">EXCITATORY</span><span class="p">)</span>

<span class="n">connProto1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">numTagBits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-Compartments-and-Connections">
<h3><span class="section-number">6.2.3. </span>Create Compartments and Connections<a class="headerlink" href="#Create-Compartments-and-Connections" title="Permalink to this headline">Â¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create Compartments</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartment</span><span class="p">(</span><span class="n">pbasic</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartment</span><span class="p">(</span><span class="n">pbasic</span><span class="p">)</span>
<span class="n">c3</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartment</span><span class="p">(</span><span class="n">plrn</span><span class="p">)</span>

<span class="c1"># Create Connections</span>
<span class="n">conn13</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span> <span class="n">connProto1</span><span class="p">)</span>
<span class="n">conn23</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span> <span class="n">connProto2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-and-Connect-Spike-Generators">
<h3><span class="section-number">6.2.4. </span>Create and Connect Spike Generators<a class="headerlink" href="#Create-and-Connect-Spike-Generators" title="Permalink to this headline">Â¶</a></h3>
<p>Configure pre-synaptic, post-synaptic, and reward spike times. Note that the reward spike arrives later than the pre/post synaptic spikes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">numPorts</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Pre-synaptic spike</span>
<span class="n">preSynapticSpikeTime</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">]</span>
<span class="n">spikeGenPreSyn</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createSpikeGenProcess</span><span class="p">(</span><span class="n">numPorts</span><span class="p">)</span>
<span class="n">spikeGenPreSyn</span><span class="o">.</span><span class="n">addSpikes</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">preSynapticSpikeTime</span><span class="p">])</span>
<span class="n">connPreSynSpikeToC2</span> <span class="o">=</span> <span class="n">spikeGenPreSyn</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">connProto1</span><span class="p">)</span>

<span class="c1"># Post-synpatic spike</span>
<span class="n">postSynapticSpikeTime</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span>
<span class="n">spikeGenPostSyn</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createSpikeGenProcess</span><span class="p">(</span><span class="n">numPorts</span><span class="p">)</span>
<span class="n">spikeGenPostSyn</span><span class="o">.</span><span class="n">addSpikes</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">postSynapticSpikeTime</span><span class="p">])</span>
<span class="n">connPostSynSpikeToC1</span> <span class="o">=</span> <span class="n">spikeGenPostSyn</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">connProto1</span><span class="p">)</span>

<span class="c1"># Reward spike</span>
<span class="n">rewardTime</span> <span class="o">=</span> <span class="p">[</span><span class="mi">26</span><span class="p">]</span>
<span class="n">spikeGenReward</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createSpikeGenProcess</span><span class="p">(</span><span class="n">numPorts</span><span class="p">)</span>
<span class="n">spikeGenReward</span><span class="o">.</span><span class="n">addSpikes</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">rewardTime</span><span class="p">])</span>
<span class="n">connRewardSpikeToLrnRule</span> <span class="o">=</span> <span class="n">spikeGenReward</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">reinforcementChannel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Configure-Probes">
<h2><span class="section-number">6.3. </span>Configure Probes<a class="headerlink" href="#Configure-Probes" title="Permalink to this headline">Â¶</a></h2>
<p>Probe the behavior of compartment 3 (c3), the learning connection (conn23), and the reward connection.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">conn23PrbSyn</span> <span class="o">=</span> <span class="n">conn23</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SYNAPSE_WEIGHT</span><span class="p">,</span>
                             <span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SYNAPSE_TAG</span><span class="p">])</span>
<span class="n">c3Probes</span> <span class="o">=</span> <span class="n">c3</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">,</span>
                     <span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">,</span>
                     <span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">])</span>
<span class="n">rewardProbe</span> <span class="o">=</span> <span class="n">connRewardSpikeToLrnRule</span><span class="o">.</span><span class="n">probe</span><span class="p">([</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">REWARD_TRACE</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Run-the-Network">
<h2><span class="section-number">6.4. </span>Run the Network<a class="headerlink" href="#Run-the-Network" title="Permalink to this headline">Â¶</a></h2>
<p>Run the network for 100 timesteps.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">runTime</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">runTime</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.81:18861
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  N2Driver: Running...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling synapses... Done (0.00s)
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing probes... Done (0.00s)
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Writing modified registers... Done (0.01s)
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Initializing... Done (0.01s)
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Preparing input... Done (0.02s)
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing... Done (0.07s)
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeSeries... Done (0.01s)
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  N2Driver: Finished (0.12s)
</pre></div></div>
</div>
</div>
<div class="section" id="Results">
<h2><span class="section-number">6.5. </span>Results<a class="headerlink" href="#Results" title="Permalink to this headline">Â¶</a></h2>
<p>Compartment 3 spikes at timestep 18, and due to the STDP learning rule, the tag field increases. The reward spike is injected at timestep 26 and the reward trace increases. The synaptic weight then also increases due to the non-zero reward trace and tag.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">c3Probes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;c3 u0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">c3Probes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;c3 v0&#39;</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">c3Probes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax0</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;c3 spikes 0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">conn23PrbSyn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;conn23 Tag (Learning Enabled)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">conn23PrbSyn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;conn23 Wgt (Learning Enabled)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">rewardProbe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Reward Trace 0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_f_rewards_learning_19_0.png" src="../_images/jupyter_f_rewards_learning_19_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="g_snip_for_threshold_modulation.html" class="btn btn-neutral float-right" title="7. SNIPs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="e_neuronal_homeostasis.html" class="btn btn-neutral float-left" title="5. Neuronal homeostasis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, Intel Corporation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>