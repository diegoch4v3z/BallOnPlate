

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>10. Hard vs. soft membrane voltage reset &mdash; NxSDK 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11. Soft reset membrane voltage" href="j_soft_reset_net.html" />
    <link rel="prev" title="9. Performance profiling" href="i_performance_profiling.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NxSDK
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introductory Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxapi.html">NxAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxnet.html">NxNet API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxcore.html">NxCore API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composable.html">Composability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../embedded_execution_engine.html">Embedded Execution Engine</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../nxnet_tutorials.html">NxNet Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="a_compartment_setup.html">1. Compartment, CompartmentPrototype and Probes Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="b_connecting_compartments.html">2. Connecting compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="c_stimulating_compartments.html">3. Stimulating compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="d_synaptic_plasticity.html">4. Synaptic plasticity</a></li>
<li class="toctree-l3"><a class="reference internal" href="e_neuronal_homeostasis.html">5. Neuronal homeostasis</a></li>
<li class="toctree-l3"><a class="reference internal" href="f_rewards_learning.html">6. Learning with Rewards</a></li>
<li class="toctree-l3"><a class="reference internal" href="g_snip_for_threshold_modulation.html">7. SNIPs</a></li>
<li class="toctree-l3"><a class="reference internal" href="h_reward_trace.html">8. Reward Trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="i_performance_profiling.html">9. Performance profiling</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">10. Hard vs. soft membrane voltage reset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Configuration-parameters">10.1. Configuration parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Network-setup">10.2. Network setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Run-network">10.3. Run network</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Plot-utility">10.4. Plot utility</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Results">10.5. Results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_net.html">11. Soft reset membrane voltage</a></li>
<li class="toctree-l3"><a class="reference internal" href="k_interactive_spike_sender_receiver.html">12. Interactive Spike Sender and Spike Receivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="l_snip_for_compartment_setup_with_NxNet_C.html">13. Setup Compartments with NxNet C API</a></li>
<li class="toctree-l3"><a class="reference internal" href="m_independent_networks_in_same_run.html">14. Independent Networks in Same Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html">15. Stochastic Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#C.-Puttin-It-All-Together">16. C. Puttin It All Together</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#Modify-createWtaMotif1-to-Include-Detector-Neuron">17. Modify createWtaMotif1 to Include Detector Neuron</a></li>
<li class="toctree-l3"><a class="reference internal" href="o_snip_for_reading_lakemont_spike_count.html">18. Read Lakemont Spike Count</a></li>
<li class="toctree-l3"><a class="reference internal" href="p_composable_networks.html">19. Composable Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="q_connection_sharing.html">20. Connection Sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html">21. Stubs and NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html#NetModules">22. NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="s_multicx_neuron_self_reward.html">23. Implementation of a multi-compartment neuron with self-reward feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="t_vMinExp_and_vMaxExp.html">24. vMinExp and vMaxExp Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html">25. Neurons vs Compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html#Multi-compartment-neurons">26. Multi-compartment neurons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../nxcore_tutorials.html">NxCore Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Nx SDK Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance-suite.html">NxSDK Performance Test Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">NxSDK Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NxSDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
          <li><a href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">10. </span>Hard vs. soft membrane voltage reset</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># INTEL CORPORATION CONFIDENTIAL AND PROPRIETARY</span>
<span class="c1">#</span>
<span class="c1"># Copyright © 2018-2021 Intel Corporation.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are Intel copyrighted</span>
<span class="c1"># materials, and your use of them is governed by the express</span>
<span class="c1"># license under which they were provided to you (License). Unless</span>
<span class="c1"># the License provides otherwise, you may not use, modify, copy,</span>
<span class="c1"># publish, distribute, disclose or transmit  this software or the</span>
<span class="c1"># related documents without Intel&#39;s prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are provided as is, with</span>
<span class="c1"># no express or implied warranties, other than those that are</span>
<span class="c1"># expressly stated in the License.</span>
</pre></div>
</div>
</div>
<div class="section" id="Hard-vs. soft-membrane-voltage-reset">
<h1><span class="section-number">10. </span>Hard vs. soft membrane voltage reset<a class="headerlink" href="#Hard-vs. soft-membrane-voltage-reset" title="Permalink to this headline">¶</a></h1>
<p>Loihi’s built-in membrane voltage reset mechanism performs a “hard” reset which always resets the membrane voltage back to zero, regardless of how much the membrane voltage exceeds the spiking threshold. This can lead to inaccuracies for rate codes and so a “soft” reset mechanism is desirable by which the membrane threshold only gets subtracted from the current membrane voltage above threshold.</p>
<p>To realize a “soft” reset, either a two or three compartment neuron can be constructed using Loihi’s multi-compartment features. In this scenario, the synaptic input is integrated via “dendritic” compartments that do not spike and a “somatic” compartment at the root of the dendritic tree that emits regular output spikes but also inhibits its own “dendritic” compartments via an inhibitory connection whereby the inhibitory weight corresponds to the negative membrane threshold.</p>
<p>This workaround allows to realize a “soft” membrane reset, however, at the expense of additional compartment resources per neuro core.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">nxsdk.arch.n2a.n2board</span> <span class="kn">import</span> <span class="n">N2Board</span>
<span class="kn">from</span> <span class="nn">nxsdk.graph.nxinputgen.nxinputgen</span> <span class="kn">import</span> <span class="n">BasicSpikeGenerator</span>
</pre></div>
</div>
</div>
<div class="section" id="Configuration-parameters">
<h2><span class="section-number">10.1. </span>Configuration parameters<a class="headerlink" href="#Configuration-parameters" title="Permalink to this headline">¶</a></h2>
<p>These are some shared neuron parameters we use for all three neurons.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tauU</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">tauV</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">decayU</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tauU</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">)</span>
<span class="n">decayV</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tauV</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">)</span>
<span class="n">vth</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">inWgt</span> <span class="o">=</span> <span class="mi">35</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Network-setup">
<h2><span class="section-number">10.2. </span>Network setup<a class="headerlink" href="#Network-setup" title="Permalink to this headline">¶</a></h2>
<p>In the following we are going to set up three neurons on a single core that all receive the same spiking input from a spike generator. The first is a single compartment (cxId=0) neuron serves as a reference and performs a “hard” membrane potential reset when its membrane potential exceeds the spikiing thresholds. The two- (cxId=1..2) and three-compartment (cxId=3..5) neurons perform a “soft” reset. ### Setup N2Core This sets up the board with a single chip and core. All neurons use the same
threshold. cxMetaState phases need to be initialized as IDLE for the multi-compartment neurons to work.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">board</span> <span class="o">=</span> <span class="n">N2Board</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numChips</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numCores</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">initNumSynapses</span><span class="o">=</span><span class="p">[[</span><span class="mi">10</span><span class="p">]])</span>
<span class="n">n2Core</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">n2Chips</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n2Cores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">n2Core</span><span class="o">.</span><span class="n">numUpdates</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">numUpdates</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">vthProfileCfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">staticCfg</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">vth</span><span class="o">=</span><span class="n">vth</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">dendriteSharedCfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">dsOffset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                      <span class="n">dmOffsets</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxMetaState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">phase0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">phase1</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">phase2</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">phase3</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxMetaState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">phase0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">phase1</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">phase2</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">phase3</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Setup-SpikeGenerator-that-excites-single-,-two--and-three-compartment-neurons">
<h3><span class="section-number">10.2.1. </span>Setup SpikeGenerator that excites single-, two- and three-compartment neurons<a class="headerlink" href="#Setup-SpikeGenerator-that-excites-single-,-two--and-three-compartment-neurons" title="Permalink to this headline">¶</a></h3>
<p>Here we setup a spike generator sending spikes to the first input axon (synMapId=0) at t=5, 10, 15, 20, 25. The input compartments of the three neurons are at cxId 0 (single-comppartment neuron), 1 (two-compartment neuron) and 2 (three-compartment neuron).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create input generator</span>
<span class="n">sg</span> <span class="o">=</span> <span class="n">BasicSpikeGenerator</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">addSpike</span><span class="p">(</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">addSpike</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">addSpike</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">addSpike</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">addSpike</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Connect spike generator to input compartments</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">synapsePtr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">synapseLen</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">discreteMapEntry</span><span class="o">.</span><span class="n">cxBase</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">n2Core</span><span class="o">.</span><span class="n">synapses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">CIdx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Wgt</span><span class="o">=</span><span class="n">inWgt</span><span class="p">,</span> <span class="n">synFmtId</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">synapses</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">CIdx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Wgt</span><span class="o">=</span><span class="n">inWgt</span><span class="p">,</span> <span class="n">synFmtId</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">synapses</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">CIdx</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">Wgt</span><span class="o">=</span><span class="n">inWgt</span><span class="p">,</span> <span class="n">synFmtId</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">n2Core</span><span class="o">.</span><span class="n">synapseFmt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">numSynapses</span><span class="o">=</span><span class="mi">63</span><span class="p">,</span>
                               <span class="n">idxBits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">fanoutType</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">compression</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                               <span class="n">wgtBits</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/home/joyeshmi/nxsdk-nxsdk/nxsdk/graph/nxinputgen/../../snips/
</pre></div></div>
</div>
</div>
<div class="section" id="Setup-reference-compartment-performing-regular-“hard”-reset">
<h3><span class="section-number">10.2.2. </span>Setup reference compartment performing regular “hard” reset<a class="headerlink" href="#Setup-reference-compartment-performing-regular-“hard”-reset" title="Permalink to this headline">¶</a></h3>
<p>The single-compartment neuron is supposed to fire when the membrane potential exceeds the spiking threshold. Thus we set threshOp=0.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxProfileCfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">decayU</span><span class="o">=</span><span class="n">decayU</span><span class="p">,</span>
                                 <span class="n">decayV</span><span class="o">=</span><span class="n">decayV</span><span class="p">,</span>
                                 <span class="n">threshOp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxCfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cxProfile</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vthProfile</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Setup-two-compartment-neuron-performing-“soft”-reset">
<h3><span class="section-number">10.2.3. </span>Setup two-compartment neuron performing “soft” reset<a class="headerlink" href="#Setup-two-compartment-neuron-performing-“soft”-reset" title="Permalink to this headline">¶</a></h3>
<p>The “dendritic” input compartment (cxId=1) uses threshOp=2 which makes it only evaluates the membrane potential but it won’t fire when its membrane voltage crosses the membrane potential and thus the membrane potential won’t experience a “hard” reset to 0. Instead it pushes the event S = v&gt;vth onto the multi-compartment stack by setting stackOut=1.</p>
<p>The “somatic” output compartment (cxId=2) pops the event S from the multi-compartment stack and since it uses joinOp=6 (OR_S) it will fire immediately when its input compartment crosses threshold.</p>
<p>The “somatic” compartment can be configured to connect anywhere. Here we only connect it back to the “dendritic” input compartment with a weight proportional to the negative membrane threshold. Since the “dendritic” compartment has a finite decayU constant, we scale down the membrane potential such that the integral weight equals the negative membrane potential:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_0^\infty w^{inh}\cdot e^{-\delta^u \cdot t} dt = \frac{w^{inh}}{\delta^u} = -v^{th},~\delta^u=\frac{decayU}{4096}\in{0..1}\\
w^{inh} = -v^{th}\cdot \frac{decayU}{4096}\end{split}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Configure two-compartment neuron</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxProfileCfg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">decayU</span><span class="o">=</span><span class="n">decayU</span><span class="p">,</span>
                                 <span class="n">decayV</span><span class="o">=</span><span class="n">decayV</span><span class="p">,</span>
                                 <span class="n">threshOp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">stackOut</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxProfileCfg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">decayU</span><span class="o">=</span><span class="mi">4095</span><span class="p">,</span>
                                 <span class="n">decayV</span><span class="o">=</span><span class="mi">4095</span><span class="p">,</span>
                                 <span class="n">threshOp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">stackIn</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">joinOp</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxCfg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cxProfile</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vthProfile</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxCfg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cxProfile</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vthProfile</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Connect somatic compartment with dendritic compartment</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">createDiscreteAxon</span><span class="p">(</span><span class="n">srcCxId</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dstChipId</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dstCoreId</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dstSynMapId</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">n2Core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">synapsePtr</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">synapseLen</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">discreteMapEntry</span><span class="o">.</span><span class="n">cxBase</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">wgtInh</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">vth</span> <span class="o">*</span> <span class="n">decayU</span><span class="o">/</span><span class="mi">4096</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">synapses</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">CIdx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Wgt</span><span class="o">=</span><span class="n">wgtInh</span><span class="p">,</span> <span class="n">synFmtId</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Setup-three-compartment-neuron-performing-“soft”-reset">
<h3><span class="section-number">10.2.4. </span>Setup three-compartment neuron performing “soft” reset<a class="headerlink" href="#Setup-three-compartment-neuron-performing-“soft”-reset" title="Permalink to this headline">¶</a></h3>
<p>The three-compartment neuron operates similarly to the two-compartment neuron except that the former “dendritic” input compartment is separated into two compartments: one which integrates the regular synaptic input which then feeds into another compartment that integrates only the inhibitory spike from the “somatic” compartment without any filtering to avoid the effect of temporal integration of the membrane voltage reset.</p>
<p>The synaptic input compartment (cxId=3) and somatic compartment (cxId=5) are configured just like the compartments of the two-compartment neuron above with the exception that the decayV constant of the “dendritic” input compartment is set to 4095. As a result, the synaptic input current is passed without any further filtering to the middle compartment (cxId=4) which also integrates the reset spike from the “somatic” compartment without further filtering into its membrane potential which then
decays with the former decayV constant.</p>
<p>Thus this allows to realize a clean “soft” reset without side effects.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Configure three-compartment neuron</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxProfileCfg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">decayU</span><span class="o">=</span><span class="n">decayU</span><span class="p">,</span>
                                 <span class="n">decayV</span><span class="o">=</span><span class="mi">4095</span><span class="p">,</span>
                                 <span class="n">threshOp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">stackOut</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxProfileCfg</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">decayU</span><span class="o">=</span><span class="mi">4095</span><span class="p">,</span>
                                 <span class="n">decayV</span><span class="o">=</span><span class="n">decayV</span><span class="p">,</span>
                                 <span class="n">threshOp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">stackIn</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">stackOut</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">joinOp</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxProfileCfg</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">decayU</span><span class="o">=</span><span class="mi">4095</span><span class="p">,</span>
                                 <span class="n">decayV</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">threshOp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">stackIn</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">joinOp</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxCfg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cxProfile</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">vthProfile</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxCfg</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cxProfile</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">vthProfile</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">cxCfg</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cxProfile</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">vthProfile</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Connect somatic compartment with middle compartment</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">createDiscreteAxon</span><span class="p">(</span><span class="n">srcCxId</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dstChipId</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dstCoreId</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dstSynMapId</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">n2Core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">synapsePtr</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">synapseLen</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n2Core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">discreteMapEntry</span><span class="o">.</span><span class="n">cxBase</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">n2Core</span><span class="o">.</span><span class="n">synapses</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">CIdx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">Wgt</span><span class="o">=-</span><span class="n">vth</span><span class="p">,</span> <span class="n">synFmtId</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-probes-and-run">
<h3><span class="section-number">10.2.5. </span>Create probes and run<a class="headerlink" href="#Create-probes-and-run" title="Permalink to this headline">¶</a></h3>
<p>Here we create probes for all u, v and output spikes of all compartments of the individual neurons.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mon</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">monitor</span>
<span class="c1"># Single-compartment neuron probes</span>
<span class="n">u0Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">v0Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">s0Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;spike&#39;</span><span class="p">)</span>

<span class="c1"># Two-compartment neuron probes</span>
<span class="n">u1Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">v1Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">s1Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;spike&#39;</span><span class="p">)</span>
<span class="n">u2Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">v2Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">s2Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;spike&#39;</span><span class="p">)</span>

<span class="c1"># Three-compartment neuron probes</span>
<span class="n">u3Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">v3Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">s3Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;spike&#39;</span><span class="p">)</span>
<span class="n">u4Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">v4Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">s4Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;spike&#39;</span><span class="p">)</span>
<span class="n">u5Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">v5Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">s5Probe</span> <span class="o">=</span> <span class="n">mon</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">n2Core</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;spike&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Run-network">
<h2><span class="section-number">10.3. </span>Run network<a class="headerlink" href="#Run-network" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">board</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">board</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.81:34733
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 0.19s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling snips.............Done 0.24s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 1.45ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.14ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 2.59s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 2.71ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 2.95ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 1.29ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 3.40ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 5.34ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 30 timesteps..........Done 3.05s
</pre></div></div>
</div>
</div>
<div class="section" id="Plot-utility">
<h2><span class="section-number">10.4. </span>Plot utility<a class="headerlink" href="#Plot-utility" title="Permalink to this headline">¶</a></h2>
<p>Here we define a function that will plot the u, v and spike probes of a compartment vertically stacked. The global membrane potential is drawn as a horizontal dashed red line.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">plotCxState</span><span class="p">(</span><span class="n">uProbe</span><span class="p">,</span> <span class="n">vProbe</span><span class="p">,</span> <span class="n">sProbe</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
    <span class="n">uProbe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="o">+</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">vProbe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">vth</span><span class="o">*</span><span class="mi">64</span><span class="p">,</span> <span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">num</span><span class="o">+</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">sProbe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Results">
<h2><span class="section-number">10.5. </span>Results<a class="headerlink" href="#Results" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Single-compartment-neuron">
<h3><span class="section-number">10.5.1. </span>Single compartment neuron<a class="headerlink" href="#Single-compartment-neuron" title="Permalink to this headline">¶</a></h3>
<p>The weights and threshold are configured such that the neuron spikes at the third input spike after which the membrane potential performs a “hard” reset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Single-compartment neuron&#39;</span><span class="p">)</span>
<span class="n">plotCxState</span><span class="p">(</span><span class="n">u0Probe</span><span class="p">,</span> <span class="n">v0Probe</span><span class="p">,</span> <span class="n">s0Probe</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_j_soft_reset_core_22_0.png" src="../_images/jupyter_j_soft_reset_core_22_0.png" />
</div>
</div>
</div>
<div class="section" id="Two-compartment-neuron">
<h3><span class="section-number">10.5.2. </span>Two-compartment neuron<a class="headerlink" href="#Two-compartment-neuron" title="Permalink to this headline">¶</a></h3>
<p>Here the membrane potential will also exceed threshold in response to the third input spike but the membrane potential v1 does not reset immediately. However in that same time step, the “somatic” compartment spikes and sends a spike back to the “dendritic” compartment. Thus in the next time step u1 decreases strongly (but not by the full amount of vth) which then gets subtracted from v1 over time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Multi-compartment neuron&#39;</span><span class="p">)</span>
<span class="n">plotCxState</span><span class="p">(</span><span class="n">u1Probe</span><span class="p">,</span> <span class="n">v1Probe</span><span class="p">,</span> <span class="n">s1Probe</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plotCxState</span><span class="p">(</span><span class="n">u2Probe</span><span class="p">,</span> <span class="n">v2Probe</span><span class="p">,</span> <span class="n">s2Probe</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_j_soft_reset_core_24_0.png" src="../_images/jupyter_j_soft_reset_core_24_0.png" />
</div>
</div>
</div>
<div class="section" id="Three-compartment-neuron">
<h3><span class="section-number">10.5.3. </span>Three compartment neuron<a class="headerlink" href="#Three-compartment-neuron" title="Permalink to this headline">¶</a></h3>
<p>Here the behavior is similar as for the two-compartment neuron with the exception that upon the spike of the “somatic” compartment the full value of vth gets intgrated into u2 and subtraced from v2 at once. Of course in the time step after the spike, the -vth and the current input from v1 are added by v2 and thus the reset of v2 is slightly less than vth.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Multi-compartment neuron&#39;</span><span class="p">)</span>
<span class="n">plotCxState</span><span class="p">(</span><span class="n">u3Probe</span><span class="p">,</span> <span class="n">v3Probe</span><span class="p">,</span> <span class="n">s3Probe</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plotCxState</span><span class="p">(</span><span class="n">u4Probe</span><span class="p">,</span> <span class="n">v4Probe</span><span class="p">,</span> <span class="n">s4Probe</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plotCxState</span><span class="p">(</span><span class="n">u5Probe</span><span class="p">,</span> <span class="n">v5Probe</span><span class="p">,</span> <span class="n">s5Probe</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_j_soft_reset_core_26_0.png" src="../_images/jupyter_j_soft_reset_core_26_0.png" />
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="j_soft_reset_net.html" class="btn btn-neutral float-right" title="11. Soft reset membrane voltage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="i_performance_profiling.html" class="btn btn-neutral float-left" title="9. Performance profiling" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, Intel Corporation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>