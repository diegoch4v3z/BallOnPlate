

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Characterization Tutorial &mdash; NxSDK 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DNN" href="../dnn.html" />
    <link rel="prev" title="Barrier Synchronization Testing" href="timeAndEnergyBarrierSync.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NxSDK
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introductory Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxapi.html">NxAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxnet.html">NxNet API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxcore.html">NxCore API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composable.html">Composability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../embedded_execution_engine.html">Embedded Execution Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Nx SDK Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../characterization.html">Characterization</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../characterization.html#tutorials">Tutorials</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="i_performance_profiling.html">9. Performance profiling</a></li>
<li class="toctree-l4"><a class="reference internal" href="timeAndEnergyBarrierSync.html">Barrier Synchronization Testing</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Characterization Tutorial</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dnn.html">DNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dvs.html">DVS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../epl.html">EPL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../knn.html">K Nearest Neighbour</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input_generator.html">Input Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lca.html">LCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../path_planning.html">Path Planning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../slayer.html">SLAYER Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../slic.html">SLIC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spike_streamer.html">Spike Streamer Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trace_injection.html">Trace Injection Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../performance-suite.html">NxSDK Performance Test Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">NxSDK Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NxSDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../modules.html">Nx SDK Modules</a> &raquo;</li>
        
          <li><a href="../characterization.html">Characterization</a> &raquo;</li>
        
      <li>Characterization Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># INTEL CORPORATION CONFIDENTIAL AND PROPRIETARY</span>
<span class="c1">#</span>
<span class="c1"># Copyright © 2020-2021 Intel Corporation.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are Intel copyrighted</span>
<span class="c1"># materials, and your use of them is governed by the express</span>
<span class="c1"># license under which they were provided to you (License). Unless</span>
<span class="c1"># the License provides otherwise, you may not use, modify, copy,</span>
<span class="c1"># publish, distribute, disclose or transmit  this software or the</span>
<span class="c1"># related documents without Intel&#39;s prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are provided as is, with</span>
<span class="c1"># no express or implied warranties, other than those that are</span>
<span class="c1"># expressly stated in the License.</span>
</pre></div>
</div>
</div>
<div class="section" id="Characterization-Tutorial">
<h1>Characterization Tutorial<a class="headerlink" href="#Characterization-Tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial implements a characterization workload as described in the accompanying INRC paper. The tutorial relies on a configurable workload which takes 6 parameters: - The state of each neuron “INACTIVE”/“IDLE”/“SPIKING” - The number of neurons per core - The number of output axons per neuron - The distance (in tiles) between source and destination cores - The number of 64 bit Synaptic Memory words read by each arriving spike - The number of synapses contained in each 64 bit Synaptic Memory
word</p>
<p>The neuron states are: - <strong>INACTIVE</strong>: power gated and does not require updating - <strong>IDLE</strong>: updated on every timestep, but not generating any spikes - <strong>SPIKING</strong>: biased strongly enough to spike on every timestep</p>
<p>The figure below shows the flow. When a neuron spikes, it activates a configurable list of axons, where each axons specifies a core that a spike must be routed to. When the spike arrives at the receiving core, it triggers the retrieval of a list of Synaptic Memory words, each of which can contain multiple synapses. The synaptic updates are performed, but we turn off all neurons on the receiving core, so they never process their accumulated synaptic input.</p>
<p><img alt="Processing pipeline" src="../_images/processingPipeline.png" /></p>
<p>The distance travelled by the spikes is controlled by changing where the target cores lie in the chip. <img alt="Source and Sink Tiles" src="../_images/source_sink_tiles.png" /></p>
<p>The number of operations performed can be calculated based on the parameters in the figure below <img alt="Computation" src="../_images/computation.png" /></p>
<p>Our helper function will calculate the number of ops explicitly and returns the counts as a dictionary used below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">nxsdk_modules.characterization.src.characterization</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">nxsdk.logutils.nxlogging</span> <span class="kn">import</span> <span class="n">set_verbosity</span><span class="p">,</span> <span class="n">LoggingLevel</span>
<span class="n">set_verbosity</span><span class="p">(</span><span class="n">LoggingLevel</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>External vLab:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#KAPOHO_BAY = os.environ.get(&#39;KAPOHOBAY&#39;)</span>
<span class="c1">#if KAPOHO_BAY:</span>
    <span class="c1">## need to set boardName</span>
    <span class="c1">#numChips=2</span>
<span class="c1">#else:</span>
    <span class="c1">#boardName=&#39;ncl-ext-ghrd-01&#39;</span>
    <span class="c1">#numChips=32</span>
</pre></div>
</div>
</div>
<p>Internal vLab:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">KAPOHO_BAY</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;KAPOHOBAY&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">KAPOHO_BAY</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running on KB</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">boardName</span><span class="o">=</span><span class="s1">&#39;ncl-nuc-01&#39;</span>
    <span class="n">numChips</span><span class="o">=</span><span class="mi">2</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running on Nahuku</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">boardName</span><span class="o">=</span><span class="s1">&#39;ncl-ghrd-01&#39;</span>
    <span class="n">numChips</span><span class="o">=</span><span class="mi">32</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running on Nahuku

</pre></div></div>
</div>
<div class="section" id="Neuron-Count-and-State">
<h2>Neuron Count and State<a class="headerlink" href="#Neuron-Count-and-State" title="Permalink to this headline">¶</a></h2>
<p>In the first test, the number of neurons per core is swept and the effect on timestep duration and energy is observed. The test is repeated for all 3 neuron states.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">if</span> <span class="n">KAPOHO_BAY</span><span class="p">:</span>
    <span class="n">numNeuronsPerCore</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">128</span><span class="p">,</span><span class="mi">192</span><span class="p">,</span><span class="mi">256</span><span class="p">,</span><span class="mi">384</span><span class="p">,</span><span class="mi">512</span><span class="p">,</span><span class="mi">768</span><span class="p">,</span><span class="mi">1024</span><span class="p">])</span>
    <span class="n">runTime</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">numNeuronsPerCore</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">256</span><span class="p">,</span><span class="mi">512</span><span class="p">,</span><span class="mi">1024</span><span class="p">])</span>
    <span class="n">runTime</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">neuronStates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;INACTIVE&#39;</span><span class="p">,</span> <span class="s1">&#39;IDLE&#39;</span><span class="p">,</span> <span class="s1">&#39;SPIKING&#39;</span><span class="p">]</span>
<span class="n">opName</span> <span class="o">=</span> <span class="s1">&#39;Neuron Update&#39;</span>

<span class="k">for</span> <span class="n">neuronStateTestValue</span> <span class="ow">in</span> <span class="n">neuronStates</span><span class="p">:</span>
    <span class="n">titleName</span> <span class="o">=</span> <span class="n">neuronStateTestValue</span>
    <span class="n">timePerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">neuroCoreDynamicEnergyPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">totalNeuronUpdatesPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">coreNeuronUpdatesPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">numNeuronsTestValue</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> Neurons per core&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numNeuronsTestValue</span><span class="p">,</span> <span class="n">neuronStateTestValue</span><span class="p">))</span>
        <span class="n">ops</span><span class="p">,</span> <span class="n">powerStats</span> <span class="o">=</span> <span class="n">testWorkload</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="o">=</span><span class="n">numNeuronsTestValue</span><span class="p">,</span>
                     <span class="n">neuronState</span><span class="o">=</span><span class="n">neuronStateTestValue</span><span class="p">,</span>
                     <span class="n">outputAxonsPerNeuron</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">spikeDistance</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">synapseMemWordsPerSpike</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">synapsesPerWord</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">runTime</span><span class="o">=</span><span class="n">runTime</span><span class="p">,</span>
                     <span class="n">boardName</span><span class="o">=</span><span class="n">boardName</span><span class="p">,</span>
                     <span class="n">numChips</span><span class="o">=</span><span class="n">numChips</span><span class="p">)</span>

        <span class="n">neuroCoreDynamicEnergyPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">powerStats</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="s1">&#39;core&#39;</span><span class="p">][</span><span class="s1">&#39;dynamic&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">powerStats</span><span class="o">.</span><span class="n">timePerTimestep</span><span class="o">/</span><span class="mf">1e3</span> <span class="c1">#/1e3 to convert to uJ</span>

        <span class="n">totalNeuronUpdatesPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ops</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">][</span><span class="s1">&#39;neuronUpdates&#39;</span><span class="p">]</span>
        <span class="n">coreNeuronUpdatesPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ops</span><span class="p">[</span><span class="s1">&#39;perCore&#39;</span><span class="p">][</span><span class="s1">&#39;neuronUpdates&#39;</span><span class="p">]</span>

        <span class="n">timePerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">powerStats</span><span class="o">.</span><span class="n">timePerTimestep</span>
    <span class="n">fitPowerPerOp</span><span class="p">(</span><span class="n">totalNeuronUpdatesPerTimestep</span><span class="p">,</span> <span class="n">neuroCoreDynamicEnergyPerTimestep</span><span class="p">,</span> <span class="n">opName</span><span class="p">,</span> <span class="n">titleName</span><span class="o">=</span><span class="n">titleName</span><span class="p">)</span>
    <span class="n">fitTimePerOp</span><span class="p">(</span><span class="n">coreNeuronUpdatesPerTimestep</span><span class="p">,</span> <span class="n">timePerTimestep</span><span class="p">,</span> <span class="n">opName</span><span class="p">,</span> <span class="n">titleName</span><span class="o">=</span><span class="n">titleName</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running 1 INACTIVE Neurons per core
Running 2 INACTIVE Neurons per core
Running 4 INACTIVE Neurons per core
Running 8 INACTIVE Neurons per core
Running 16 INACTIVE Neurons per core
Running 32 INACTIVE Neurons per core
Running 64 INACTIVE Neurons per core
Running 128 INACTIVE Neurons per core
Running 256 INACTIVE Neurons per core
Running 512 INACTIVE Neurons per core
Running 1024 INACTIVE Neurons per core
    Processing timeseries... s...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_8_1.png" src="../_images/jupyter_timeAndEnergyPerOp_8_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_8_2.png" src="../_images/jupyter_timeAndEnergyPerOp_8_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running 1 IDLE Neurons per core
Running 2 IDLE Neurons per core..
Running 4 IDLE Neurons per core..
Running 8 IDLE Neurons per core..
Running 16 IDLE Neurons per core.
Running 32 IDLE Neurons per core.
Running 64 IDLE Neurons per core.
Running 128 IDLE Neurons per core
Running 256 IDLE Neurons per core
Running 512 IDLE Neurons per core
Running 1024 IDLE Neurons per core
    Processing timeseries... s...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_8_4.png" src="../_images/jupyter_timeAndEnergyPerOp_8_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_8_5.png" src="../_images/jupyter_timeAndEnergyPerOp_8_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running 1 SPIKING Neurons per core
Running 2 SPIKING Neurons per core
Running 4 SPIKING Neurons per core
Running 8 SPIKING Neurons per core
Running 16 SPIKING Neurons per core
Running 32 SPIKING Neurons per core
Running 64 SPIKING Neurons per core
Running 128 SPIKING Neurons per core
Running 256 SPIKING Neurons per core
Running 512 SPIKING Neurons per core
Running 1024 SPIKING Neurons per core
    Processing timeseries... s...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_8_7.png" src="../_images/jupyter_timeAndEnergyPerOp_8_7.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_8_8.png" src="../_images/jupyter_timeAndEnergyPerOp_8_8.png" />
</div>
</div>
<p>Unsurprisingly, timestep duration and energy both show a clear linear relationship to the number of neurons per core.</p>
<p>The neurons state also affects timestep duration, with INACTIVE neurons being the fastest, IDLE neurons taking longer, and SPIKING NEURONS taking the longest.</p>
</div>
<div class="section" id="Spike-Generation">
<h2>Spike Generation<a class="headerlink" href="#Spike-Generation" title="Permalink to this headline">¶</a></h2>
<p>The second test sweeps the number of axons per neuron (and therefore the number of output spikes per neuron).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">if</span> <span class="n">KAPOHO_BAY</span><span class="p">:</span>
    <span class="n">numAxonsPerNeuron</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">192</span><span class="p">,</span><span class="mi">256</span><span class="p">,</span><span class="mi">384</span><span class="p">,</span><span class="mi">512</span><span class="p">,</span><span class="mi">768</span><span class="p">,</span><span class="mi">1023</span><span class="p">])</span>
    <span class="n">runTime</span><span class="o">=</span><span class="mi">100000</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">numAxonsPerNeuron</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">256</span><span class="p">,</span><span class="mi">512</span><span class="p">,</span><span class="mi">1023</span><span class="p">])</span>
<span class="n">opName</span> <span class="o">=</span> <span class="s1">&#39;Output Axon Activation&#39;</span>

<span class="n">timePerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numAxonsPerNeuron</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">neuroCoreDynamicEnergyPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numAxonsPerNeuron</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">totalAxonActivationsPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numAxonsPerNeuron</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">coreAxonActivationsPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numAxonsPerNeuron</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">numAxonsTestValue</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numAxonsPerNeuron</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running </span><span class="si">{}</span><span class="s2"> Axons per Neuron&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numAxonsTestValue</span><span class="p">))</span>
    <span class="n">ops</span><span class="p">,</span> <span class="n">powerStats</span> <span class="o">=</span> <span class="n">testWorkload</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">neuronState</span><span class="o">=</span><span class="s1">&#39;SPIKING&#39;</span><span class="p">,</span>
                 <span class="n">outputAxonsPerNeuron</span><span class="o">=</span><span class="n">numAxonsTestValue</span><span class="p">,</span>
                 <span class="n">spikeDistance</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">synapseMemWordsPerSpike</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">synapsesPerWord</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">runTime</span><span class="o">=</span><span class="n">runTime</span><span class="p">,</span>
                 <span class="n">boardName</span><span class="o">=</span><span class="n">boardName</span><span class="p">,</span>
                 <span class="n">numChips</span><span class="o">=</span><span class="n">numChips</span><span class="p">)</span>

    <span class="n">neuroCoreDynamicEnergyPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">powerStats</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="s1">&#39;core&#39;</span><span class="p">][</span><span class="s1">&#39;dynamic&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">powerStats</span><span class="o">.</span><span class="n">timePerTimestep</span><span class="o">/</span><span class="mf">1e3</span> <span class="c1">#/1e3 to convert to uJ</span>

    <span class="n">totalAxonActivationsPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ops</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">][</span><span class="s1">&#39;spikes&#39;</span><span class="p">]</span>
    <span class="n">coreAxonActivationsPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ops</span><span class="p">[</span><span class="s1">&#39;perCore&#39;</span><span class="p">][</span><span class="s1">&#39;spikes&#39;</span><span class="p">]</span>

    <span class="n">timePerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">powerStats</span><span class="o">.</span><span class="n">timePerTimestep</span>

<span class="n">fitPowerPerOp</span><span class="p">(</span><span class="n">totalAxonActivationsPerTimestep</span><span class="p">,</span> <span class="n">neuroCoreDynamicEnergyPerTimestep</span><span class="p">,</span> <span class="n">opName</span><span class="p">)</span>
<span class="n">fitTimePerOp</span><span class="p">(</span><span class="n">coreAxonActivationsPerTimestep</span><span class="p">,</span> <span class="n">timePerTimestep</span><span class="p">,</span> <span class="n">opName</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running 0 Axons per Neuron
Running 1 Axons per Neuron.. s...
Running 2 Axons per Neuron.. s...
Running 4 Axons per Neuron.. s...
Running 8 Axons per Neuron.. s...
Running 16 Axons per Neuron. s...
Running 32 Axons per Neuron. s...
Running 64 Axons per Neuron. s...
Running 128 Axons per Neuron s...
Running 256 Axons per Neuron s...
Running 512 Axons per Neuron s...
Running 1023 Axons per Neurons...
    Processing timeseries... s...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_11_1.png" src="../_images/jupyter_timeAndEnergyPerOp_11_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_11_2.png" src="../_images/jupyter_timeAndEnergyPerOp_11_2.png" />
</div>
</div>
<p>Similar to before, timestep duration and energy both show a clear linear relationship to the number of spikes generated.</p>
</div>
<div class="section" id="Spike-Distance">
<h2>Spike Distance<a class="headerlink" href="#Spike-Distance" title="Permalink to this headline">¶</a></h2>
<p>The third test sweeps the distance (measured in tiles) travelled by each spike and measures the power consumption. Spike routing is very fast, so the timestep duration is defined by the much slower spike receiving at the receiving core, and therefore we will not see the effect of spike distance on timestep duration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">spikeDistances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="n">opName</span> <span class="o">=</span> <span class="s1">&#39;Spike Tile-Hop&#39;</span>

<span class="n">timePerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">spikeDistances</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">neuroCoreDynamicEnergyPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">spikeDistances</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">totalSpikeHopsPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">spikeDistances</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">spikeDistanceValue</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">spikeDistances</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running </span><span class="si">{}</span><span class="s2"> tile-hops per spike&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spikeDistanceValue</span><span class="p">))</span>
    <span class="n">ops</span><span class="p">,</span> <span class="n">powerStats</span> <span class="o">=</span> <span class="n">testWorkload</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">neuronState</span><span class="o">=</span><span class="s1">&#39;SPIKING&#39;</span><span class="p">,</span>
                 <span class="n">outputAxonsPerNeuron</span><span class="o">=</span><span class="mi">1023</span><span class="p">,</span>
                 <span class="n">spikeDistance</span><span class="o">=</span><span class="n">spikeDistanceValue</span><span class="p">,</span>
                 <span class="n">synapseMemWordsPerSpike</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">synapsesPerWord</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">runTime</span><span class="o">=</span><span class="n">runTime</span><span class="p">,</span>
                 <span class="n">boardName</span><span class="o">=</span><span class="n">boardName</span><span class="p">,</span>
                 <span class="n">numChips</span><span class="o">=</span><span class="n">numChips</span><span class="p">)</span>


    <span class="n">neuroCoreDynamicEnergyPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">powerStats</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="s1">&#39;core&#39;</span><span class="p">][</span><span class="s1">&#39;dynamic&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">powerStats</span><span class="o">.</span><span class="n">timePerTimestep</span><span class="o">/</span><span class="mf">1e3</span> <span class="c1">#/1e3 to convert to uJ</span>

    <span class="n">totalSpikeHopsPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ops</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">][</span><span class="s1">&#39;spikeHops&#39;</span><span class="p">]</span>

<span class="n">fitPowerPerOp</span><span class="p">(</span><span class="n">totalSpikeHopsPerTimestep</span><span class="p">,</span> <span class="n">neuroCoreDynamicEnergyPerTimestep</span><span class="p">,</span> <span class="n">opName</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running 1 tile-hops per spike
Running 2 tile-hops per spikes...
Running 3 tile-hops per spikes...
Running 4 tile-hops per spikes...
Running 5 tile-hops per spikes...
Running 6 tile-hops per spikes...
Running 7 tile-hops per spikes...
    Processing timeseries... s...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_14_1.png" src="../_images/jupyter_timeAndEnergyPerOp_14_1.png" />
</div>
</div>
<p>Again we see a clear linear relationship between power and the distance travelled by each spike.</p>
</div>
<div class="section" id="Synaptic-Word-processing">
<h2>Synaptic Word processing<a class="headerlink" href="#Synaptic-Word-processing" title="Permalink to this headline">¶</a></h2>
<p>This test sweeps the number of synaptic words indexed by each spike received.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">if</span> <span class="n">KAPOHO_BAY</span><span class="p">:</span>
    <span class="n">synMemWordsPerSpike</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">255</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">synMemWordsPerSpike</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">255</span><span class="p">])</span>
<span class="n">opName</span> <span class="o">=</span> <span class="s1">&#39;Synapse Mem Word Lookup&#39;</span>

<span class="n">timePerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">synMemWordsPerSpike</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">neuroCoreDynamicEnergyPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">synMemWordsPerSpike</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">totalSynMemWordsPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">synMemWordsPerSpike</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">coreSynMemWordsPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">synMemWordsPerSpike</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">synMemWordsValue</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">synMemWordsPerSpike</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running </span><span class="si">{}</span><span class="s2"> Synaptic Memory Words per spike&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">synMemWordsValue</span><span class="p">))</span>
    <span class="n">ops</span><span class="p">,</span> <span class="n">powerStats</span> <span class="o">=</span> <span class="n">testWorkload</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                 <span class="n">neuronState</span><span class="o">=</span><span class="s1">&#39;SPIKING&#39;</span><span class="p">,</span>
                 <span class="n">outputAxonsPerNeuron</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">spikeDistance</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">synapseMemWordsPerSpike</span><span class="o">=</span><span class="n">synMemWordsValue</span><span class="p">,</span>
                 <span class="n">synapsesPerWord</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">runTime</span><span class="o">=</span><span class="n">runTime</span><span class="p">,</span>
                 <span class="n">boardName</span><span class="o">=</span><span class="n">boardName</span><span class="p">,</span>
                 <span class="n">numChips</span><span class="o">=</span><span class="n">numChips</span><span class="p">)</span>


    <span class="n">neuroCoreDynamicEnergyPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">powerStats</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="s1">&#39;core&#39;</span><span class="p">][</span><span class="s1">&#39;dynamic&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">powerStats</span><span class="o">.</span><span class="n">timePerTimestep</span><span class="o">/</span><span class="mf">1e3</span> <span class="c1">#/1e3 to convert to uJ</span>

    <span class="n">totalSynMemWordsPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ops</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">][</span><span class="s1">&#39;synMemWords&#39;</span><span class="p">]</span>

    <span class="n">timePerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">powerStats</span><span class="o">.</span><span class="n">timePerTimestep</span>

<span class="n">fitPowerPerOp</span><span class="p">(</span><span class="n">totalSynMemWordsPerTimestep</span><span class="p">,</span> <span class="n">neuroCoreDynamicEnergyPerTimestep</span><span class="p">,</span> <span class="n">opName</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running 0 Synaptic Memory Words per spike
Running 1 Synaptic Memory Words per spike
Running 2 Synaptic Memory Words per spike
Running 4 Synaptic Memory Words per spike
Running 8 Synaptic Memory Words per spike
Running 16 Synaptic Memory Words per spike
Running 32 Synaptic Memory Words per spike
Running 64 Synaptic Memory Words per spike
Running 128 Synaptic Memory Words per spike
Running 255 Synaptic Memory Words per spike
    Processing timeseries... s...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_17_1.png" src="../_images/jupyter_timeAndEnergyPerOp_17_1.png" />
</div>
</div>
<p>The time and energy per synaptic memory word can be calculated as usual by fitting a line.</p>
</div>
<div class="section" id="Synaptic-Operations">
<h2>Synaptic Operations<a class="headerlink" href="#Synaptic-Operations" title="Permalink to this headline">¶</a></h2>
<p>The final test sweeps the number of synapses per word to control the number of synaptic operations performed, while keeping all other operations constant</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">synapsesPerWord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">])</span>
<span class="n">opName</span> <span class="o">=</span> <span class="s1">&#39;Synaptic Op&#39;</span>

<span class="n">timePerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">synapsesPerWord</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">neuroCoreDynamicEnergyPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">synapsesPerWord</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">totalSynopsPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">synapsesPerWord</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">coreSynopsPerTimestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">synapsesPerWord</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">synapsesPerWordValue</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">synapsesPerWord</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running </span><span class="si">{}</span><span class="s2"> Synapses per Synaptic Memory Word&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">synapsesPerWordValue</span><span class="p">))</span>
    <span class="n">ops</span><span class="p">,</span> <span class="n">powerStats</span> <span class="o">=</span> <span class="n">testWorkload</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">neuronState</span><span class="o">=</span><span class="s1">&#39;SPIKING&#39;</span><span class="p">,</span>
                 <span class="n">outputAxonsPerNeuron</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">spikeDistance</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">synapseMemWordsPerSpike</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
                 <span class="n">synapsesPerWord</span><span class="o">=</span><span class="n">synapsesPerWordValue</span><span class="p">,</span>
                 <span class="n">runTime</span><span class="o">=</span><span class="n">runTime</span><span class="p">,</span>
                 <span class="n">boardName</span><span class="o">=</span><span class="n">boardName</span><span class="p">,</span>
                 <span class="n">numChips</span><span class="o">=</span><span class="n">numChips</span><span class="p">)</span>

    <span class="n">neuroCoreDynamicEnergyPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">powerStats</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="s1">&#39;core&#39;</span><span class="p">][</span><span class="s1">&#39;dynamic&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">powerStats</span><span class="o">.</span><span class="n">timePerTimestep</span><span class="o">/</span><span class="mf">1e3</span> <span class="c1">#/1e3 to convert to uJ</span>

    <span class="n">totalSynopsPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ops</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">][</span><span class="s1">&#39;synOps&#39;</span><span class="p">]</span>
    <span class="n">coreSynopsPerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ops</span><span class="p">[</span><span class="s1">&#39;perCore&#39;</span><span class="p">][</span><span class="s1">&#39;synOps&#39;</span><span class="p">]</span>

    <span class="n">timePerTimestep</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">powerStats</span><span class="o">.</span><span class="n">timePerTimestep</span>

<span class="n">fitPowerPerOp</span><span class="p">(</span><span class="n">totalSynopsPerTimestep</span><span class="p">,</span> <span class="n">neuroCoreDynamicEnergyPerTimestep</span><span class="p">,</span> <span class="n">opName</span><span class="p">)</span>
<span class="n">fitTimePerOp</span><span class="p">(</span><span class="n">coreSynopsPerTimestep</span><span class="p">,</span> <span class="n">timePerTimestep</span><span class="p">,</span> <span class="n">opName</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running 4 Synapses per Synaptic Memory Word
Running 8 Synapses per Synaptic Memory Word
Running 16 Synapses per Synaptic Memory Word
Running 32 Synapses per Synaptic Memory Word
    Processing timeseries... s...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_20_1.png" src="../_images/jupyter_timeAndEnergyPerOp_20_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_timeAndEnergyPerOp_20_2.png" src="../_images/jupyter_timeAndEnergyPerOp_20_2.png" />
</div>
</div>
<p>Again, timestep duration and energy consumption both show a clear linear relationship to the number of synaptic operations being performed.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../dnn.html" class="btn btn-neutral float-right" title="DNN" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="timeAndEnergyBarrierSync.html" class="btn btn-neutral float-left" title="Barrier Synchronization Testing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, Intel Corporation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>