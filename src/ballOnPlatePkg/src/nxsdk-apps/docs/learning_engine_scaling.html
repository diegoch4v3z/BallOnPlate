

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Learning Engine Scaling &mdash; NxSDK 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Building Multi Compartment Neuron Model using Stack Operations" href="multicompartment.html" />
    <link rel="prev" title="Learning with Reinforcement" href="learning_reinforcements.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> NxSDK
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introductory Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="nxapi.html">NxAPI</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="nxnet.html">NxNet API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="compartment.html">Compartment and CompartmentPrototype</a></li>
<li class="toctree-l2"><a class="reference internal" href="connection.html">Connection and ConnectionPrototype</a></li>
<li class="toctree-l2"><a class="reference internal" href="connectionsharing.html">Connection Sharing</a></li>
<li class="toctree-l2"><a class="reference internal" href="neuron.html">Neuron and NeuronPrototype</a></li>
<li class="toctree-l2"><a class="reference internal" href="groups.html">Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="netprobes.html">Working with Probes and Monitors in NxNet</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="learningrule.html">Specifying a Learning Rule</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="learning_reinforcements.html">Learning with Reinforcement</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Learning Engine Scaling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="multicompartment.html">Building Multi Compartment Neuron Model using Stack Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="spikeinjectionandreceivers.html">Spike Injection and Spike Receivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="nxlogging.html">Logging in NxNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="nxcompiler.html">NxCompiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="nxnet_resource_map.html">NxNet Resource Map Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nxcore.html">NxCore API</a></li>
<li class="toctree-l1"><a class="reference internal" href="composable.html">Composability</a></li>
<li class="toctree-l1"><a class="reference internal" href="embedded_execution_engine.html">Embedded Execution Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Nx SDK Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance-suite.html">NxSDK Performance Test Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">NxSDK Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NxSDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="nxnet.html">NxNet API</a> &raquo;</li>
        
          <li><a href="learningrule.html">Specifying a Learning Rule</a> &raquo;</li>
        
      <li>Learning Engine Scaling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="learning-engine-scaling">
<h1>Learning Engine Scaling<a class="headerlink" href="#learning-engine-scaling" title="Permalink to this headline">Â¶</a></h1>
<p>The Loihi learning engine hardware supports learning rules that take on a sum of products form as shown below:</p>
<div class="figure align-default">
<img alt="figure 1 - Generic learning rule description" src="_images/learning_rule_mathematical_description.png" />
</div>
<p>where Z_l is a synaptic state variable (i.e. weight, delay, tag), D_r is a dependency factor (i.e. x0, y0, r0, uk),
S_r is a scaling constant, and F_{l,r,s} is a multiplicative factor (e.g. x1, y1, w).</p>
<p>Given that the computation is implemented with fixed point multipliers and accumulators, the Loihi learning engine does
introduce implicit scaling into the computation to avoid overflowing the accumulator.  Specifically, when computing the
product of the N_F terms and S_r, the following iterative computation is done:</p>
<div class="figure align-default">
<img alt="figure 2 - Product term computation" src="_images/learning_rule_iterative_mult.png" />
</div>
<p>where bar{P}_s accumulates the product.  Note that bar{P}_{N_F+1} is up shifted by the exponent of S_r before being
summed. b_s is defined as follows:</p>
<div class="figure align-default">
<img alt="figure 3 - Product scaling factor" src="_images/learning_rule_mult_scaling.png" />
</div>
<p>where B^A = 15 and the width of f_k depends on the factor, e.g. width(w) = 8, width(d) = 6, width(t) = 8, width(s_r^{mant}) = 3.</p>
<p>The interative product computation introduces the bit shift b_s that changes the numerical result of the learning engine
if three factors are multiplied. As an example, consider the following learning connection:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createLearningRule</span><span class="p">(</span><span class="n">dw</span><span class="o">=</span><span class="s1">&#39;x0*w*w&#39;</span><span class="p">,</span>
                             <span class="n">x1Impulse</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                             <span class="n">x1TimeConstant</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                             <span class="n">y1Impulse</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                             <span class="n">y1TimeConstant</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                             <span class="n">tEpoch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">connProto2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">enableLearning</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">learningRule</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
</pre></div>
</div>
<p>Assume 2 spikes are injected into the connection at t0 and t1, where t0 &lt; t1.  The resulting weight after each spike is
shown below.</p>
<p><strong>At t0 spike</strong></p>
<p>Starting weight: 10</p>
<ul class="simple">
<li><p>b1 = 0</p></li>
<li><p>b2 = 16 - 15 = 1</p></li>
<li><p>b3 = 19 - 1 - 15 = 3</p></li>
<li><p>bar{P}_1 = (1 &gt;&gt; 0) * 10 = 10</p></li>
<li><p>bar{P}_2 = (10 &gt;&gt; 1) * 10 = 50</p></li>
<li><p>bar{P}_3 = (50 &gt;&gt; 3) * 1 = 6</p></li>
<li><p>dw = 6</p></li>
</ul>
<p>Ending weight: w = w + dw = 16</p>
<p><strong>At t1 spike</strong></p>
<p>Starting weight: 16</p>
<ul class="simple">
<li><p>b1 = 0</p></li>
<li><p>b2 = 16 - 15 = 1</p></li>
<li><p>b3 = 19 - 1 - 15 = 3</p></li>
<li><p>bar{P}_1 = (1 &gt;&gt; 0) * 16 = 16</p></li>
<li><p>bar{P}_2 = (16 &gt;&gt; 1) * 16 = 128</p></li>
<li><p>bar{P}_3 = (128 &gt;&gt; 3) * 1 = 16</p></li>
<li><p>dw = 16</p></li>
</ul>
<p>Ending weight: w = w + dw = 32</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="multicompartment.html" class="btn btn-neutral float-right" title="Building Multi Compartment Neuron Model using Stack Operations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="learning_reinforcements.html" class="btn btn-neutral float-left" title="Learning with Reinforcement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, Intel Corporation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>