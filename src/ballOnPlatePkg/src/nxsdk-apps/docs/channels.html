

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Communicating vis Channels &mdash; NxSDK 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Programming SNIPs on Host" href="host_snips.html" />
    <link rel="prev" title="Programming SNIPs" href="snips.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> NxSDK
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="introduction.html">Introductory Material</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="introduction.html#creating-and-running-spiking-neural-networks-on-loihi">Creating and Running Spiking Neural Networks on Loihi</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="learning.html">Learning with STDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="snips.html">Programming SNIPs</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Communicating vis Channels</a></li>
<li class="toctree-l3"><a class="reference internal" href="host_snips.html">Programming SNIPs on Host</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="nxapi.html">NxAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="nxnet.html">NxNet API</a></li>
<li class="toctree-l1"><a class="reference internal" href="nxcore.html">NxCore API</a></li>
<li class="toctree-l1"><a class="reference internal" href="composable.html">Composability</a></li>
<li class="toctree-l1"><a class="reference internal" href="embedded_execution_engine.html">Embedded Execution Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Nx SDK Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance-suite.html">NxSDK Performance Test Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">NxSDK Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NxSDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="introduction.html">Introductory Material</a> &raquo;</li>
        
      <li>Communicating vis Channels</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="communicating-vis-channels">
<h1>Communicating vis Channels<a class="headerlink" href="#communicating-vis-channels" title="Permalink to this headline">¶</a></h1>
<p>Channels are the abstraction using which we can send data from superhost to the snip process running on the lakemont and vice-versa.
To be able to send and receive data via channel, it must be connected to a snip. A channel can be of send type or recv. It is not bidirectional. Depending on how the connection
is made between the snip and the superhost, channel's directionality is determined.</p>
<div class="figure align-default">
<img alt="" src="_images/sniparch.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># API to create channel</span>
<span class="k">def</span> <span class="nf">createChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">elementType</span><span class="p">,</span> <span class="n">numElements</span><span class="p">,</span> <span class="n">behavior</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
     <span class="sd">&quot;&quot;&quot;Creates a channel as a means of data communication between Superhost and Host</span>

<span class="sd">     :param name: Channel Name</span>
<span class="sd">     :param elementType: Only supports &quot;int&quot; and &quot;packed&quot; for now</span>
<span class="sd">     :param numElements: Maximum capacity of the channel</span>
<span class="sd">     :param behavior: Not implemented</span>
<span class="sd">     :return: channel</span>
<span class="sd">     &quot;&quot;&quot;</span>
</pre></div>
</div>
<span class="target" id="module-nxsdk.graph.channel"></span><p>Channel module for process communication</p>
<dl class="py class">
<dt id="nxsdk.graph.channel.Channel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">nxsdk.graph.channel.</span></code><code class="sig-name descname"><span class="pre">Channel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nxGraph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">messageSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numElements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nxsdk.graph.channel.Channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Channel abstraction for connecting two processes</p>
<dl class="py method">
<dt id="nxsdk.graph.channel.Channel.connect">
<code class="sig-name descname"><span class="pre">connect</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nxsdk.graph.channel.Channel.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>The function which dictates the direction of communication.
For superhost None is used for process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p1</strong> -- Sending Process</p></li>
<li><p><strong>p2</strong> -- Receiving Process</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nxsdk.graph.channel.Channel.index">
<code class="sig-name descname"><span class="pre">index</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">int</span><a class="headerlink" href="#nxsdk.graph.channel.Channel.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of this channel in the list of channels</p>
</dd></dl>

<dl class="py method">
<dt id="nxsdk.graph.channel.Channel.isChannelEmpty">
<code class="sig-name descname"><span class="pre">isChannelEmpty</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nxsdk.graph.channel.Channel.isChannelEmpty" title="Permalink to this definition">¶</a></dt>
<dd><p>Not Implemented</p>
</dd></dl>

<dl class="py method">
<dt id="nxsdk.graph.channel.Channel.load">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">load</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">board</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#nxsdk.graph.channel.Channel" title="nxsdk.graph.channel.Channel"><span class="pre">Channel</span></a><a class="headerlink" href="#nxsdk.graph.channel.Channel.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads an embedded given a board</p>
</dd></dl>

<dl class="py method">
<dt id="nxsdk.graph.channel.Channel.numElementFree">
<code class="sig-name descname"><span class="pre">numElementFree</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nxsdk.graph.channel.Channel.numElementFree" title="Permalink to this definition">¶</a></dt>
<dd><p>Not Implemented</p>
</dd></dl>

<dl class="py method">
<dt id="nxsdk.graph.channel.Channel.numElementOccupied">
<code class="sig-name descname"><span class="pre">numElementOccupied</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nxsdk.graph.channel.Channel.numElementOccupied" title="Permalink to this definition">¶</a></dt>
<dd><p>Not Implemented</p>
</dd></dl>

<dl class="py method">
<dt id="nxsdk.graph.channel.Channel.probe">
<code class="sig-name descname"><span class="pre">probe</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">int</span><a class="headerlink" href="#nxsdk.graph.channel.Channel.probe" title="Permalink to this definition">¶</a></dt>
<dd><p>Probe if there are elements which could be written or read from the channel.
Function to probe channel
In case of send channel will return if one more message can be written by
returning 1 for availability and 0 for not.
In case of recv channel will return if one more message can be read by
returning 1 and if not 0.
If underlying API returns -1, raises exception to signal error
(e.g. channel does not exist etc.)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns int</dt>
<dd class="field-odd"><p>result of probing depending on send/recv</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nxsdk.graph.channel.Channel.read">
<code class="sig-name descname"><span class="pre">read</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numElements</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nxsdk.graph.channel.Channel.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read numElements data from the channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>numElements</strong> -- Number of elements to be read</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of data read</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="nxsdk.graph.channel.Channel.save">
<code class="sig-name descname"><span class="pre">save</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nxsdk.graph.channel.Channel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the channel to directory represented by path</p>
</dd></dl>

<dl class="py method">
<dt id="nxsdk.graph.channel.Channel.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numElements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nxsdk.graph.channel.Channel.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write numElements data into channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>numElements</strong> -- Number of elements to be written</p></li>
<li><p><strong>data</strong> -- data to be written</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p>How Channels work?</p>
<p>When a channel is created, a buffer of size numElements of elementType is created on the host. When a write call on channel is made,
the data is written to the buffer and when a read call is made, the data is read from the buffer. Channels operate asynchronously,
in a standard producer-consumer fashion. Provided there is data in the buffer to read, readChannel will read it.
If there is no data in the buffer, a readChannel call will block. Similarly, provided there is room in the buffer to write numelements, writeChannel will write it. However, if the buffer is full, writeChannel may hang. Therefore it is important to read faster than write.</p>
<p>Following code illustrates how to use channels :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># First create a snip which will use the channel</span>
<span class="n">cPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span><span class="o">+</span> <span class="s2">&quot;/spiking.c&quot;</span>
<span class="n">includeDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">funcName</span> <span class="o">=</span> <span class="s2">&quot;run_spiking&quot;</span>
<span class="n">guardName</span> <span class="o">=</span> <span class="s2">&quot;do_spiking&quot;</span>
<span class="n">phase</span> <span class="o">=</span> <span class="s2">&quot;spiking&quot;</span>
<span class="n">spikingProcess</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">createProcess</span><span class="p">(</span><span class="s2">&quot;spikingProcess&quot;</span><span class="p">,</span><span class="n">cPath</span><span class="p">,</span><span class="n">includeDir</span><span class="p">,</span>
                                  <span class="n">funcName</span><span class="p">,</span> <span class="n">guardName</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>

<span class="c1"># Creates a channel named spikeChannel for sending spike data</span>
<span class="n">spikeChannel</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">createChannel</span><span class="p">(</span><span class="s1">&#39;nxspiking&#39;</span><span class="p">,</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="c1"># Connects spikeChannel from Superhost to spikingProcess making it send channel</span>
<span class="n">spikeChannel</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">spikingProcess</span><span class="p">)</span>

<span class="c1"># Create a channel named recvChannel for getting the value of tEpoch</span>
<span class="n">recvChannel</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">createChannel</span><span class="p">(</span><span class="s1">&#39;nxrecv&#39;</span><span class="p">,</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="c1"># Connecting imageChannel from initProcess to SuperHost making it receive channel</span>
<span class="n">recvChannel</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">spikingProcess</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// In the snip spiking.c</span>
 <span class="k">static</span> <span class="kt">int</span> <span class="n">data</span><span class="p">;</span>
 <span class="n">sttaic</span> <span class="kt">int</span> <span class="n">spikeChannelID</span> <span class="o">=</span> <span class="n">getChannelID</span><span class="p">(</span><span class="s">&quot;nxspiking&quot;</span><span class="p">);</span>
 <span class="k">static</span> <span class="kt">int</span> <span class="n">recvChannelID</span>  <span class="o">=</span> <span class="n">getChannelID</span><span class="p">(</span><span class="s">&quot;nxrecv&quot;</span><span class="p">);</span>

<span class="c1">// Reading 1 element from the spikeChannel into data</span>
<span class="n">readChannel</span><span class="p">(</span><span class="n">spikeChannelID</span><span class="p">,</span><span class="o">&amp;</span><span class="n">data</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Writing 1 element(value od data) to the recvChannel</span>
<span class="n">writeChannel</span><span class="p">(</span><span class="n">recvChannelID</span><span class="p">,</span><span class="o">&amp;</span><span class="n">data</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>By default elementType is &quot;int&quot;, which supports single message of 4 byte size. The SDK supports &quot;packed&quot; element type as well, which supports
message size of 16 integers, which means in a single call to read and write function 16 4-bytes elements can be read or written.</p>
<p>A simple code snippet to illustrate &quot;packed&quot; mode :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Channel creation, define elementType as packed</span>
<span class="n">spikeChannel</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">createChannel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;nxspk&#39;</span><span class="p">,</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;packed&quot;</span><span class="p">,</span> <span class="n">numElements</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">spikeChannel</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//In your Snip</span>
<span class="k">static</span> <span class="kt">int32_t</span> <span class="n">spikeData</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">channelID</span> <span class="o">=</span> <span class="mi">-1</span><span class="p">;</span>
<span class="n">channelID</span> <span class="o">=</span> <span class="n">getChannelID</span><span class="p">(</span><span class="s">&quot;nxspk&quot;</span><span class="p">);</span>
<span class="n">readChannel</span><span class="p">(</span><span class="n">channelID</span><span class="p">,</span> <span class="n">spikeData</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//spike data should be able to read 1,2,3,4 in sa single call</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="host_snips.html" class="btn btn-neutral float-right" title="Programming SNIPs on Host" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="snips.html" class="btn btn-neutral float-left" title="Programming SNIPs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, Intel Corporation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>